import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as x}from"./index-BOnQTV8N.js";import{N as j}from"./Number2Currency-e57Tgsuk.js";import{m as f}from"./main-Bp3JhiuO.js";import{G as P}from"./Global-BM4Id4Pw.js";import{B as z,a as D,D as H}from"./DeliveryPricesRest-CepPhj8K.js";import{B as Q}from"./book-C1IPlXSj.js";import{T as $}from"./trash-2-DU7LB6-f.js";import{M as W}from"./minus-Db6MFKEO.js";import{P as Y}from"./plus-CTIomuuF.js";import{u as _,S as A}from"./SelectForm-CoB1IHa7.js";import{I as S}from"./InputForm-BW2Lnisr.js";import{c as X}from"./createLucideIcon-DfjclApS.js";import"./index-yBjzXJbu.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./___vite-browser-external_commonjs-proxy-DDYoOVPM.js";import"./chevron-down-uIVDLcM-.js";import"./search-BQ59Robe.js";import"./check-D5vaIe6v.js";/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=X("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),Z=({setCart:l,...s})=>{var m,p;const i=()=>{l(o=>o.filter(u=>u.id!==s.id))},d=()=>{s.type!=="custom_album"&&l(o=>o.map(u=>u.id===s.id?{...u,quantity:(u.quantity||1)+1}:u))},c=()=>{if(s.type==="custom_album"){i();return}l(o=>o.map(u=>{if(u.id===s.id){const a=(u.quantity||1)-1;return a<=0?(i(s.id),null):{...u,quantity:a}}return u}).filter(Boolean))},g=()=>{var o;return s.type==="custom_album"?s.image&&s.image.startsWith("data:")?s.image:s.image?`/storage/images/item/${s.image}`:(o=s.preset_data)!=null&&o.cover_image?`/storage/images/item/${s.preset_data.cover_image}`:"/default-album.jpg":`/storage/images/item/${s.image}`};return console.log(s),e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:g(),alt:s.name,className:"w-20 h-20 object-cover rounded"}),s.type==="custom_album"&&e.jsx("div",{className:"absolute -top-2 -right-2 bg-orange-500 text-white rounded-full p-1",children:e.jsx(Q,{size:12})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-lg mb-2",children:s.name}),s.type==="custom_album"?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Tipo: ",e.jsx("span",{className:"customtext-neutral-dark",children:"🎨 Álbum Personalizado"})]}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Páginas: ",e.jsx("span",{className:"customtext-neutral-dark",children:((m=s.album_data)==null?void 0:m.pages_count)||"N/A"})]}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Estado: ",e.jsx("span",{className:"customtext-neutral-dark text-green-600",children:"Diseño Personalizado"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Marca: ",e.jsx("span",{className:"customtext-neutral-dark",children:((p=s.brand)==null?void 0:p.name)||"Sin marca"})]}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Disponibilidad: ",e.jsx("span",{className:"customtext-neutral-dark",children:(s.stock||0)>=(s.quantity||1)?"En stock":"Agotado"})]}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["SKU: ",e.jsx("span",{className:"customtext-neutral-dark",children:s.sku||"N/A"})]})]})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"w-36 text-right",children:[e.jsxs("div",{className:"text-xs text-gray-500 line-through",children:["S/ ",Number((s.price||0)*(s.quantity||1)).toFixed(2)]}),e.jsxs("div",{className:"font-bold text-lg mt-2",children:["S/ ",Number((s.final_price||s.price||0)*(s.quantity||1)).toFixed(2)]}),e.jsx("div",{className:"flex items-center gap-4 mt-2",children:s.type==="custom_album"?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"border border-gray-200 rounded-lg px-3 py-1 bg-gray-50",children:e.jsxs("span",{className:"font-semibold text-sm",children:["Qty: ",s.quantity||1]})}),e.jsx("button",{onClick:i,className:"p-2 text-gray-400 hover:text-red-500 transition-colors duration-200 rounded-full hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-red-200","aria-label":"Remove album",title:"Eliminar álbum personalizado",children:e.jsx($,{size:18})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center border border-gray-200 rounded-lg overflow-hidden shadow-sm",children:[e.jsx("button",{type:"button",onClick:c,className:"p-2 text-gray-600 hover:bg-gray-100 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary","aria-label":"Decrease quantity",children:e.jsx(W,{size:16})}),e.jsx("div",{className:"w-12 h-8 flex justify-center items-center bg-white",children:e.jsx("span",{className:"font-semibold text-sm",children:s.quantity||1})}),e.jsx("button",{type:"button",onClick:d,className:"p-2 text-gray-600 hover:bg-gray-100 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary","aria-label":"Increase quantity",children:e.jsx(Y,{size:16})})]}),e.jsx("button",{onClick:i,className:"p-2 text-gray-400 hover:text-red-500 transition-colors duration-200 rounded-full hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-red-200","aria-label":"Remove item",children:e.jsx($,{size:18})})]})})]})})]})},s.id)};function ee({cart:l,setCart:s,onContinue:i,subTotal:d,envio:c,igv:g,totalFinal:m}){console.log(l);const p=o=>{typeof o=="function"?s(u=>{const a=o(u);return f.Local.set(`${P.APP_CORRELATIVE}_cart`,a),console.log("🛒 CartStep: Carrito actualizado en localStorage:",a.length,"items"),a}):(s(o),f.Local.set(`${P.APP_CORRELATIVE}_cart`,o),console.log("🛒 CartStep: Carrito actualizado en localStorage:",o.length,"items"))};return e.jsxs("div",{className:"grid lg:grid-cols-5 gap-8",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsx("div",{className:"space-y-6",children:l.map((o,u)=>e.jsx(Z,{...o,setCart:p},u))})}),e.jsxs("div",{className:"bg-[#F7F9FB] rounded-xl shadow-lg p-6 col-span-2 h-max",children:[e.jsx("h3",{className:"text-2xl font-bold pb-6",children:"Resumen de compra"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Subtotal"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",j(d)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"IGV"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",j(g)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Envío"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",j(c)]})]}),e.jsx("div",{className:"py-3 border-y-2 mt-6",children:e.jsxs("div",{className:"flex justify-between font-bold text-[20px] items-center",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["S/ ",j(m)]})]})}),e.jsxs("div",{className:"space-y-2 pt-4",children:[e.jsx(z,{onClick:i,children:"  Continuar"}),e.jsx(D,{href:"/",children:" Cancelar"})]}),e.jsx("div",{children:e.jsxs("p",{className:"text-sm customtext-neutral-dark",children:["Al realizar tu pedido, aceptas los ",e.jsx("a",{className:"customtext-primary font-bold",children:"Términos y Condiciones"}),", y que nosotros usaremos sus datos personales de acuerdo con nuestra ",e.jsx("a",{className:"customtext-primary font-bold",children:"Política de Privacidad"}),"."]})})]})]})]})}function se(){let l="";for(let s=0;s<12;s++){const i=Math.floor(Math.random()*10);l+=i}return l}const ae=l=>new Promise((s,i)=>{try{console.log(l);const d=se(l.email);console.log(d),window.Culqi.publicKey="pk_test_f4d42a7b5073e8df",window.Culqi.settings({title:"Sala Fabulosa",email:l.email,currency:"PEN",amount:l.amount*100,order:`${d}`}),console.log(window.Culqi.settings),window.Culqi.options({lang:"es",installments:!1,paymentMethods:{tarjeta:!0,yape:!0,bancaMovil:!0,agente:!0,billetera:!0,cuotealo:!0},style:{logo:"/assets/resources/logo.png",bannerColor:"#311609",buttonBackground:"#311609"}}),window.Culqi.open(),window.culqi=async function(){try{if(!window.Culqi.token){i("No se obtuvo un token de Culqi");return}const c=window.Culqi.token.id;console.log("✅ Token generado:",c),l={...l,token:c,orderNumber:d},console.log("_request actualizado",l);const{status:g,result:m}=await f.Fetch("./api/pago",{method:"POST",body:JSON.stringify(l)});g||console.log((m==null?void 0:m.message)||"Error en el pago"),window.Culqi.close(),f.Notify.add({icon:"/assets/img/icon.svg",title:"Pago Exitoso",body:"El pago se procesó correctamente.",type:"success"}),s(m)}catch(c){f.Notify.add({icon:"/assets/img/icon.svg",title:"Error en el Pago",body:c.message,type:"danger"}),i(c.message||"Error en el pago")}},document.addEventListener("culqi.error",function(c){var g,m;f.Notify.add({icon:"/assets/img/icon.svg",title:"Error en Culqi",body:((g=c.detail)==null?void 0:g.message)||"Error desconocido",type:"danger"}),i(((m=c.detail)==null?void 0:m.message)||"Error desconocido")})}catch(d){f.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:d.message,type:"danger"}),i("Error en la integración con Culqi")}}),B=({title:l,description:s,selected:i,onSelect:d,disabled:c})=>e.jsxs("div",{className:`flex w-full items-center gap-3 p-4 border rounded-xl cursor-pointer transition-all duration-300 customtext-neutral-dark 
                }`,onClick:d,children:[e.jsx("div",{className:`w-5 h-5 border-2 rounded-full flex items-center justify-center ${i?"border-primary":""}`,children:i&&e.jsx("div",{className:"w-3 h-3 bg-primary rounded-full"})}),e.jsxs("div",{className:"customtext-neutral-light",children:[e.jsx("h4",{className:"text-sm ",children:l}),e.jsx("p",{className:"text-xs",children:s})]})]});function te({cart:l,setSale:s,setCode:i,setDelivery:d,setCart:c,onContinue:g,noContinue:m,subTotal:p,igv:o,totalFinal:u,user:a,setEnvio:q,envio:E}){const[t,v]=x.useState({name:(a==null?void 0:a.name)||"",lastname:(a==null?void 0:a.lastname)||"",email:(a==null?void 0:a.email)||"",department:(a==null?void 0:a.department)||"",province:(a==null?void 0:a.province)||"",district:(a==null?void 0:a.district)||"",address:(a==null?void 0:a.address)||"",number:(a==null?void 0:a.number)||"",comment:(a==null?void 0:a.comment)||"",reference:(a==null?void 0:a.reference)||"",shippingOption:"delivery"}),y=r=>{const{name:n,value:L}=r.target;v(k=>({...k,[n]:L}))},[b,h]=x.useState(""),[N,C]=x.useState(""),[w,F]=x.useState(""),[O,V]=x.useState([]),[G,J]=x.useState([]),[U,I]=x.useState([]),[le,oe]=x.useState(0);x.useEffect(()=>{const r=[...new Set(_.map(n=>n.departamento))];V(r)},[]),x.useEffect(()=>{if(b){const r=[...new Set(_.filter(n=>n.departamento===b).map(n=>n.provincia))];J(r),C(""),F(""),I([]),v(n=>({...n,department:b,province:"",district:""}))}},[b]),x.useEffect(()=>{if(N){const r=_.filter(n=>n.departamento===b&&n.provincia===N).map(n=>n.distrito);I(r),F(""),v(n=>({...n,province:N,district:""}))}},[N]),x.useEffect(()=>{w&&(v(n=>({...n,district:w})),(async()=>{try{const n=await H.getShippingCost({department:b,district:w});q(n.data.price),j(n.data.price)>0?T("express"):T("free")}catch(n){console.error("Error fetching shipping cost:",n),alert("No se pudo obtener el costo de envío.")}})())},[w]);const K=async r=>{if(r.preventDefault(),!a){f.Notify.add({icon:"/assets/img/icon.svg",title:"Iniciar Sesión",body:"Se requiere que incie sesión para realizar la compra",type:"danger"});return}if(!t.department||!t.province||!t.district||!t.name||!t.lastname||!t.email||!t.address||!t.reference){f.Notify.add({icon:"/assets/img/icon.svg",title:"Error en el Formulario",body:"Completar los datos de envío",type:"danger"});return}if(!window.Culqi){console.error("❌ Culqi aún no se ha cargado.");return}try{const n={user_id:(a==null?void 0:a.id)||"",name:(t==null?void 0:t.name)||"",lastname:(t==null?void 0:t.lastname)||"",fullname:`${t==null?void 0:t.name} ${t==null?void 0:t.lastname}`,email:(t==null?void 0:t.email)||"",phone:"",country:"Perú",department:b||"",province:N||"",district:w||"",ubigeo:null,address:(t==null?void 0:t.address)||"",number:(t==null?void 0:t.number)||"",comment:(t==null?void 0:t.comment)||"",reference:(t==null?void 0:t.reference)||"",amount:u||0,delivery:E,cart:l},k=await ae(n);k.status?(s(k.sale),d(k.delivery),i(k.code),c([]),g()):f.Notify.add({icon:"/assets/img/icon.svg",title:"Error en el Pago",body:"El pago ha sido rechazado",type:"danger"})}catch(n){console.log(n),f.Notify.add({icon:"/assets/img/icon.svg",title:"Error en el Pago",body:"No se llegó a procesar el pago",type:"danger"})}},[M,T]=x.useState("free");return e.jsxs("div",{className:"grid lg:grid-cols-5 gap-8",children:[e.jsxs("div",{className:"lg:col-span-3",children:[e.jsxs("form",{className:"space-y-6",onSubmit:r=>r.preventDefault(),children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(S,{type:"text",label:"Nombres",name:"name",value:t.name,onChange:y,placeholder:"Nombres"}),e.jsx(S,{label:"Apellidos",type:"text",name:"lastname",value:t.lastname,onChange:y,placeholder:"Apellidos"})]}),e.jsx(S,{label:"Correo electrónico",type:"email",name:"email",value:t.email,onChange:y,placeholder:"Ej. hola@gmail.com"}),e.jsx(A,{label:"Departamento",options:O,placeholder:"Selecciona un Departamento",onChange:r=>{h(r),v(n=>({...n,department:b}))}}),e.jsx(A,{disabled:!b,label:"Provincia",options:G,placeholder:"Selecciona una Provincia",onChange:r=>{C(r),v(n=>({...n,province:N}))}}),e.jsx(A,{disabled:!N,label:"Distrito",options:U,placeholder:"Selecciona un Distrito",onChange:r=>{F(r),v(n=>({...n,district:w}))}}),e.jsx(S,{label:"Avenida / Calle / Jirón",type:"text",name:"address",value:t.address,onChange:y,placeholder:"Ingresa el nombre de la calle"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(S,{label:"Número",type:"text",name:"number",value:t.number,onChange:y,placeholder:"Ingresa el número de la calle"}),e.jsx(S,{label:"Dpto./ Interior/ Piso/ Lote/ Bloque (opcional)",type:"text",name:"comment",value:t.comment,onChange:y,placeholder:"Ej. Casa 3, Dpto 101"})]}),e.jsx(S,{label:"Referencia",type:"text",name:"reference",value:t.reference,onChange:y,placeholder:"Ejem. Altura de la avenida..."})]}),e.jsxs("div",{className:"flex gap-4 mt-4",children:[e.jsx(B,{title:"Envío gratis",description:"Entrega entre 3 a 10 días hábiles",selected:M==="free"}),e.jsx(B,{title:"Delivery",description:"Delivery 24 horas",selected:M==="express"})]}),e.jsxs("div",{className:"flex gap-4 mt-6 bg-[#F7F9FB] p-3 rounded-xl",children:[e.jsx("div",{className:"w-5",children:e.jsx(R,{className:"customtext-primary",width:"20px"})}),e.jsxs("div",{className:"text-xs font-medium customtext-neutral-dark flex flex-col gap-2",children:[e.jsx("p",{children:"Solo Lima Metropolitana: Dentro de las 24 horas después de efectuado el pago, solo algunos distritos de Lima Metropolitana."}),e.jsxs("p",{children:[" ","Distritos No incluidos: Santa María del Mar, Pucusana, San Bartolo, Punta Hermosa, Lurín, Pachacamac, Chorrillos, Villa el Salvador, Villa María del Triunfo, San Juan de Miraflores, Cieneguilla, Ate, Chosica, Huaycan, San Juan de Lurigancho (hasta el Metro), Ancón, Santa Rosa, Carabayllo, Puente Piedra."]}),e.jsxs("p",{children:[" ","Same Day: Solo para compras efectuadas hasta las 1pm del día."]})]})]}),e.jsxs("div",{className:"flex gap-4 mt-4 bg-[#F7F9FB] p-3 rounded-xl",children:[e.jsx("div",{className:"w-5",children:e.jsx(R,{className:"customtext-primary",width:"20px"})}),e.jsx("div",{className:"text-xs font-medium customtext-neutral-dark flex flex-col gap-2",children:e.jsx("p",{children:"Lima: 3 a 4 dias hábiles | Provincia: de 4 a 10 dias hábiles"})})]})]}),e.jsxs("div",{className:"bg-[#F7F9FB] rounded-xl shadow-lg p-6 col-span-2 h-max",children:[e.jsx("h3",{className:"text-2xl font-bold pb-6",children:"Resumen de compra"}),e.jsx("div",{className:"space-y-6 border-b-2 pb-6",children:l.map((r,n)=>e.jsx("div",{className:"rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"bg-white p-2 rounded-xl",children:e.jsx("img",{src:`/storage/images/item/${r.image}`,alt:r.name,className:"w-20 h-20 object-cover rounded  "})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-lg mb-2",children:r.name}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Marca:"," ",e.jsx("span",{className:"customtext-neutral-dark",children:r.brand.name})]}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Cantidad:"," ",e.jsxs("span",{className:"customtext-neutral-dark",children:[r.quantity," "]})]}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["SKU:"," ",e.jsx("span",{className:"customtext-neutral-dark",children:r.sku})]})]})]})},r.id))}),e.jsxs("div",{className:"space-y-4 mt-6",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Subtotal"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",j(p)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"IGV"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",j(o)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Envío"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",j(E)]})]}),e.jsx("div",{className:"py-3 border-y-2 mt-6",children:e.jsxs("div",{className:"flex justify-between font-bold text-[20px] items-center",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["S/ ",j(u)]})]})}),e.jsxs("div",{className:"space-y-2 pt-4",children:[e.jsxs(z,{onClick:K,children:[" ","Continuar"]}),e.jsxs(D,{onClick:m,children:[" ","Cancelar"]})]}),e.jsx("div",{children:e.jsxs("p",{className:"text-sm customtext-neutral-dark",children:["Al realizar tu pedido, aceptas los",e.jsx("a",{className:"customtext-primary font-bold",children:"Términos y Condiciones"}),", y que nosotros usaremos sus datos personales de acuerdo con nuestra",e.jsx("a",{className:"customtext-primary font-bold",children:"Política de Privacidad"}),"."]})})]})]})]})}function ne({cart:l,code:s,delivery:i}){const c=(l.reduce((p,o)=>{const u=o.final_price;return p+u*o.quantity},0)/1.18).toFixed(2),g=(c*.18).toFixed(2),m=parseFloat(c)+parseFloat(g)+parseFloat(i);return e.jsx("div",{className:"mx-auto",children:e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("h2",{className:"text-[20px] customtext-neutral-light",children:"Gracias por tu compra 🎉"}),e.jsx("p",{className:"customtext-neutral-dark text-5xl font-semibold",children:"Tu orden ha sido recibida"}),e.jsxs("div",{className:"py-4",children:[e.jsx("div",{className:" customtext-neutral-light",children:"Código de pedido"}),e.jsx("div",{className:"customtext-neutral-dark text-lg font-semibold",children:`#${s}`})]}),e.jsxs("div",{className:"space-y-4 max-w-lg bg-[#F7F9FB] mx-auto p-8 rounded-xl",children:[e.jsx("div",{className:"space-y-6 border-b-2 pb-6",children:l.map((p,o)=>e.jsx("div",{className:"rounded-lg",children:e.jsxs("div",{className:"flex   gap-4",children:[e.jsx("div",{className:"bg-white p-2 rounded-xl w-max",children:e.jsx("img",{src:`/storage/images/item/${p.image}`,alt:p.name,className:"w-20 h-20 object-cover rounded  "})}),e.jsxs("div",{className:" text-start",children:[e.jsx("h3",{className:"font-medium text-lg mb-2",children:p.name}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Marca: ",e.jsx("span",{className:"customtext-neutral-dark",children:p.brand.name})]}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Cantidad: ",e.jsxs("span",{className:"customtext-neutral-dark",children:[p.quantity," "]})]}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["SKU: ",e.jsx("span",{className:"customtext-neutral-dark",children:p.sku})]})]})]})},o))}),e.jsxs("div",{className:"space-y-4 mt-6",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Subtotal"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",j(c)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"IGV"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",j(g)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Envío"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",j(i)]})]}),e.jsx("div",{className:"py-3 border-y-2 mt-6",children:e.jsxs("div",{className:"flex justify-between font-bold text-[20px] items-center",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["S/ ",j(m)]})]})})]}),e.jsx("div",{className:"pt-3",children:e.jsx(z,{href:"/catalogo",children:"  Seguir Comprando"})})]})]})})})}function ke({cart:l,setCart:s,user:i}){const[d,c]=x.useState(1),m=(l.reduce((h,N)=>{const C=N.final_price;return h+C*N.quantity},0)/1.18).toFixed(2),p=(m*.18).toFixed(2),[o,u]=x.useState(0),a=parseFloat(m)+parseFloat(p)+parseFloat(o),[q,E]=x.useState([]),[t,v]=x.useState([]),[y,b]=x.useState([]);return x.useEffect(()=>{console.log("🔄 CheckoutSteps: Sincronizando carrito con localStorage...");const h=f.Local.get(`${P.APP_CORRELATIVE}_cart`)||[];console.log("📦 CheckoutSteps: Carrito desde localStorage:",h),h.length>0&&JSON.stringify(h)!==JSON.stringify(l)&&(console.log("✅ CheckoutSteps: Actualizando carrito desde localStorage"),s(h))},[]),x.useEffect(()=>{const h=N=>{console.log("📢 CheckoutSteps: Carrito actualizado:",N.detail);const C=f.Local.get(`${P.APP_CORRELATIVE}_cart`)||[];console.log("🔄 CheckoutSteps: Cargando carrito actualizado:",C),s(C)};return window.addEventListener("cartUpdated",h),()=>{window.removeEventListener("cartUpdated",h)}},[s]),x.useEffect(()=>{const h=document.createElement("script");return h.src="https://checkout.culqi.com/js/v4",h.async=!0,h.onload=()=>{console.log("✅ Culqi cargado correctamente."),window.culqi=function(){window.Culqi.token?console.log("✅ Token recibido:",window.Culqi.token.id):window.Culqi.order?console.log("✅ Orden recibida:",window.Culqi.order):console.error("❌ Error en Culqi:",window.Culqi.error)}},document.body.appendChild(h),()=>{document.body.removeChild(h)}},[]),e.jsx("div",{className:"min-h-screen bg-[#F7F9FB] py-12 px-primary 2xl:px-0 2xl:max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-white   p-8 rounded-xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between max-w-3xl mx-auto",children:[e.jsx("div",{className:`text-sm ${d===1?"customtext-primary font-medium":"customtext-neutral-dark"}`,children:"1. Carrito de compra"}),e.jsx("div",{className:`text-sm ${d===2?"customtext-primary font-medium":"customtext-neutral-dark"}`,children:"2. Detalles de envío"}),e.jsx("div",{className:`text-sm ${d===3?"customtext-primary font-medium":"customtext-neutral-dark"}`,children:"3. Orden confirmada"})]}),e.jsx("div",{className:"mt-4 h-1 max-w-3xl mx-auto bg-gray-200",children:e.jsx("div",{className:"h-1 bg-primary transition-all duration-500",style:{width:`${(d-1)/2*100}%`}})})]}),d===1&&e.jsx(ee,{cart:l,setCart:s,onContinue:()=>c(2),subTotal:m,envio:o,igv:p,totalFinal:a}),d===2&&e.jsx(te,{setCode:v,setDelivery:b,cart:l,setSale:E,setCart:s,onContinue:()=>c(3),noContinue:()=>c(1),subTotal:m,envio:o,setEnvio:u,igv:p,totalFinal:a,user:i}),d===3&&e.jsx(ne,{code:t,delivery:y,cart:q,subTotal:m,envio:o,igv:p,totalFinal:a})]})})}export{ke as default};
