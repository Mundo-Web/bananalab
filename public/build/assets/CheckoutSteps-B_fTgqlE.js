import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as i}from"./index-BOnQTV8N.js";import{N as g}from"./Number2Currency-e57Tgsuk.js";import{m as j}from"./main-Bp3JhiuO.js";import{G as q}from"./Global-BM4Id4Pw.js";import{B as I,a as z,D as K}from"./DeliveryPricesRest-CepPhj8K.js";import{C as H}from"./CardItem-CdbVCrTF.js";import{u as A,S as L}from"./SelectForm-CoB1IHa7.js";import{I as k}from"./InputForm-BW2Lnisr.js";import{c as Y}from"./createLucideIcon-DfjclApS.js";import"./index-yBjzXJbu.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./___vite-browser-external_commonjs-proxy-DDYoOVPM.js";import"./book-C1IPlXSj.js";import"./minus-Db6MFKEO.js";import"./plus-CTIomuuF.js";import"./trash-2-DU7LB6-f.js";import"./chevron-down-uIVDLcM-.js";import"./search-BQ59Robe.js";import"./check-D5vaIe6v.js";/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=Y("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);function Q({cart:n,setCart:c,onContinue:m,subTotal:r,envio:l,igv:f,totalFinal:d}){console.log("üõí CartStep: Cart received:",n);const p=x=>{typeof x=="function"?c(s=>{const y=x(s);return j.Local.set(`${q.APP_CORRELATIVE}_cart`,y),console.log("üõí CartStep: Carrito actualizado en localStorage:",y.length,"items"),y}):(c(x),j.Local.set(`${q.APP_CORRELATIVE}_cart`,x),console.log("üõí CartStep: Carrito actualizado en localStorage:",x.length,"items"))},h=n.reduce((x,s)=>{const y=s.price||0,S=s.final_price||s.price||0,a=s.quantity||1;return y>S?x+(y-S)*a:x},0);return e.jsxs("div",{className:"grid lg:grid-cols-5 gap-8",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsx("div",{className:"space-y-6",children:n.map((x,s)=>e.jsx(H,{...x,setCart:p},s))})}),e.jsxs("div",{className:"bg-[#F7F9FB] rounded-xl shadow-lg p-6 col-span-2 h-max",children:[e.jsx("h3",{className:"text-2xl font-bold pb-6",children:"Resumen de compra"}),e.jsxs("div",{className:"space-y-4",children:[h>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-600 font-medium",children:"Ahorros totales"}),e.jsxs("span",{className:"font-semibold text-green-600",children:["-S/ ",g(h)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Subtotal"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",g(r)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"IGV"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",g(f)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Env√≠o"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",g(l)]})]}),e.jsx("div",{className:"py-3 border-y-2 mt-6",children:e.jsxs("div",{className:"flex justify-between font-bold text-[20px] items-center",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["S/ ",g(d)]})]})}),e.jsxs("div",{className:"space-y-2 pt-4",children:[e.jsx(I,{onClick:m,children:"  Continuar"}),e.jsx(z,{href:"/",children:" Cancelar"})]}),e.jsx("div",{children:e.jsxs("p",{className:"text-sm customtext-neutral-dark",children:["Al realizar tu pedido, aceptas los¬†",e.jsx("a",{className:"customtext-primary font-bold",children:"T√©rminos y Condiciones"}),", y que nosotros usaremos sus datos personales de acuerdo con nuestra¬†",e.jsx("a",{className:"customtext-primary font-bold",children:"Pol√≠tica de Privacidad"}),"."]})})]})]})]})}function W(){let n="";for(let c=0;c<12;c++){const m=Math.floor(Math.random()*10);n+=m}return n}const X=n=>new Promise((c,m)=>{try{console.log(n);const r=W(n.email);console.log(r),window.Culqi.publicKey="pk_test_f4d42a7b5073e8df",window.Culqi.settings({title:"Sala Fabulosa",email:n.email,currency:"PEN",amount:n.amount*100,order:`${r}`}),console.log(window.Culqi.settings),window.Culqi.options({lang:"es",installments:!1,paymentMethods:{tarjeta:!0,yape:!0,bancaMovil:!0,agente:!0,billetera:!0,cuotealo:!0},style:{logo:"/assets/resources/logo.png",bannerColor:"#311609",buttonBackground:"#311609"}}),window.Culqi.open(),window.culqi=async function(){try{if(!window.Culqi.token){m("No se obtuvo un token de Culqi");return}const l=window.Culqi.token.id;console.log("‚úÖ Token generado:",l),n={...n,token:l,orderNumber:r},console.log("_request actualizado",n);const{status:f,result:d}=await j.Fetch("./api/pago",{method:"POST",body:JSON.stringify(n)});f||console.log((d==null?void 0:d.message)||"Error en el pago"),window.Culqi.close(),j.Notify.add({icon:"/assets/img/icon.svg",title:"Pago Exitoso",body:"El pago se proces√≥ correctamente.",type:"success"}),c(d)}catch(l){j.Notify.add({icon:"/assets/img/icon.svg",title:"Error en el Pago",body:l.message,type:"danger"}),m(l.message||"Error en el pago")}},document.addEventListener("culqi.error",function(l){var f,d;j.Notify.add({icon:"/assets/img/icon.svg",title:"Error en Culqi",body:((f=l.detail)==null?void 0:f.message)||"Error desconocido",type:"danger"}),m(((d=l.detail)==null?void 0:d.message)||"Error desconocido")})}catch(r){j.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:r.message,type:"danger"}),m("Error en la integraci√≥n con Culqi")}}),O=({title:n,description:c,selected:m,onSelect:r,disabled:l})=>e.jsxs("div",{className:`flex w-full items-center gap-3 p-4 border rounded-xl cursor-pointer transition-all duration-300 customtext-neutral-dark 
                }`,onClick:r,children:[e.jsx("div",{className:`w-5 h-5 border-2 rounded-full flex items-center justify-center ${m?"border-primary":""}`,children:m&&e.jsx("div",{className:"w-3 h-3 bg-primary rounded-full"})}),e.jsxs("div",{className:"customtext-neutral-light",children:[e.jsx("h4",{className:"text-sm ",children:n}),e.jsx("p",{className:"text-xs",children:c})]})]});function Z({cart:n,setSale:c,setCode:m,setDelivery:r,setCart:l,onContinue:f,noContinue:d,subTotal:p,igv:h,totalFinal:x,user:s,setEnvio:y,envio:S}){const[a,b]=i.useState({name:(s==null?void 0:s.name)||"",lastname:(s==null?void 0:s.lastname)||"",email:(s==null?void 0:s.email)||"",department:(s==null?void 0:s.department)||"",province:(s==null?void 0:s.province)||"",district:(s==null?void 0:s.district)||"",address:(s==null?void 0:s.address)||"",number:(s==null?void 0:s.number)||"",comment:(s==null?void 0:s.comment)||"",reference:(s==null?void 0:s.reference)||"",shippingOption:"delivery"}),C=o=>{const{name:t,value:$}=o.target;b(P=>({...P,[t]:$}))},[v,u]=i.useState(""),[N,w]=i.useState(""),[E,F]=i.useState(""),[B,V]=i.useState([]),[D,G]=i.useState([]),[J,T]=i.useState([]),[se,ae]=i.useState(0);i.useEffect(()=>{const o=[...new Set(A.map(t=>t.departamento))];V(o)},[]),i.useEffect(()=>{if(v){const o=[...new Set(A.filter(t=>t.departamento===v).map(t=>t.provincia))];G(o),w(""),F(""),T([]),b(t=>({...t,department:v,province:"",district:""}))}},[v]),i.useEffect(()=>{if(N){const o=A.filter(t=>t.departamento===v&&t.provincia===N).map(t=>t.distrito);T(o),F(""),b(t=>({...t,province:N,district:""}))}},[N]),i.useEffect(()=>{E&&(b(t=>({...t,district:E})),(async()=>{try{const t=await K.getShippingCost({department:v,district:E});y(t.data.price),g(t.data.price)>0?_("express"):_("free")}catch(t){console.error("Error fetching shipping cost:",t),alert("No se pudo obtener el costo de env√≠o.")}})())},[E]);const U=async o=>{if(o.preventDefault(),!s){j.Notify.add({icon:"/assets/img/icon.svg",title:"Iniciar Sesi√≥n",body:"Se requiere que incie sesi√≥n para realizar la compra",type:"danger"});return}if(!a.department||!a.province||!a.district||!a.name||!a.lastname||!a.email||!a.address||!a.reference){j.Notify.add({icon:"/assets/img/icon.svg",title:"Error en el Formulario",body:"Completar los datos de env√≠o",type:"danger"});return}if(!window.Culqi){console.error("‚ùå Culqi a√∫n no se ha cargado.");return}try{const t={user_id:(s==null?void 0:s.id)||"",name:(a==null?void 0:a.name)||"",lastname:(a==null?void 0:a.lastname)||"",fullname:`${a==null?void 0:a.name} ${a==null?void 0:a.lastname}`,email:(a==null?void 0:a.email)||"",phone:"",country:"Per√∫",department:v||"",province:N||"",district:E||"",ubigeo:null,address:(a==null?void 0:a.address)||"",number:(a==null?void 0:a.number)||"",comment:(a==null?void 0:a.comment)||"",reference:(a==null?void 0:a.reference)||"",amount:x||0,delivery:S,cart:n},P=await X(t);P.status?(c(P.sale),r(P.delivery),m(P.code),l([]),f()):j.Notify.add({icon:"/assets/img/icon.svg",title:"Error en el Pago",body:"El pago ha sido rechazado",type:"danger"})}catch(t){console.log(t),j.Notify.add({icon:"/assets/img/icon.svg",title:"Error en el Pago",body:"No se lleg√≥ a procesar el pago",type:"danger"})}},[M,_]=i.useState("free");return e.jsxs("div",{className:"grid lg:grid-cols-5 gap-8",children:[e.jsxs("div",{className:"lg:col-span-3",children:[e.jsxs("form",{className:"space-y-6",onSubmit:o=>o.preventDefault(),children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(k,{type:"text",label:"Nombres",name:"name",value:a.name,onChange:C,placeholder:"Nombres"}),e.jsx(k,{label:"Apellidos",type:"text",name:"lastname",value:a.lastname,onChange:C,placeholder:"Apellidos"})]}),e.jsx(k,{label:"Correo electr√≥nico",type:"email",name:"email",value:a.email,onChange:C,placeholder:"Ej. hola@gmail.com"}),e.jsx(L,{label:"Departamento",options:B,placeholder:"Selecciona un Departamento",onChange:o=>{u(o),b(t=>({...t,department:v}))}}),e.jsx(L,{disabled:!v,label:"Provincia",options:D,placeholder:"Selecciona una Provincia",onChange:o=>{w(o),b(t=>({...t,province:N}))}}),e.jsx(L,{disabled:!N,label:"Distrito",options:J,placeholder:"Selecciona un Distrito",onChange:o=>{F(o),b(t=>({...t,district:E}))}}),e.jsx(k,{label:"Avenida / Calle / Jir√≥n",type:"text",name:"address",value:a.address,onChange:C,placeholder:"Ingresa el nombre de la calle"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(k,{label:"N√∫mero",type:"text",name:"number",value:a.number,onChange:C,placeholder:"Ingresa el n√∫mero de la calle"}),e.jsx(k,{label:"Dpto./ Interior/ Piso/ Lote/ Bloque (opcional)",type:"text",name:"comment",value:a.comment,onChange:C,placeholder:"Ej. Casa 3, Dpto 101"})]}),e.jsx(k,{label:"Referencia",type:"text",name:"reference",value:a.reference,onChange:C,placeholder:"Ejem. Altura de la avenida..."})]}),e.jsxs("div",{className:"flex gap-4 mt-4",children:[e.jsx(O,{title:"Env√≠o gratis",description:"Entrega entre 3 a 10 d√≠as h√°biles",selected:M==="free"}),e.jsx(O,{title:"Delivery",description:"Delivery 24 horas",selected:M==="express"})]}),e.jsxs("div",{className:"flex gap-4 mt-6 bg-[#F7F9FB] p-3 rounded-xl",children:[e.jsx("div",{className:"w-5",children:e.jsx(R,{className:"customtext-primary",width:"20px"})}),e.jsxs("div",{className:"text-xs font-medium customtext-neutral-dark flex flex-col gap-2",children:[e.jsx("p",{children:"Solo Lima Metropolitana: Dentro de las 24 horas despu√©s de efectuado el pago, solo algunos distritos de Lima Metropolitana."}),e.jsxs("p",{children:[" ","Distritos No incluidos: Santa Mar√≠a del Mar, Pucusana, San Bartolo, Punta Hermosa, Lur√≠n, Pachacamac, Chorrillos, Villa el Salvador, Villa Mar√≠a del Triunfo, San Juan de Miraflores, Cieneguilla, Ate, Chosica, Huaycan, San Juan de Lurigancho (hasta el Metro), Anc√≥n, Santa Rosa, Carabayllo, Puente Piedra."]}),e.jsxs("p",{children:[" ","Same Day: Solo para compras efectuadas hasta las 1pm del d√≠a."]})]})]}),e.jsxs("div",{className:"flex gap-4 mt-4 bg-[#F7F9FB] p-3 rounded-xl",children:[e.jsx("div",{className:"w-5",children:e.jsx(R,{className:"customtext-primary",width:"20px"})}),e.jsx("div",{className:"text-xs font-medium customtext-neutral-dark flex flex-col gap-2",children:e.jsx("p",{children:"Lima: 3 a 4 dias h√°biles | Provincia: de 4 a 10 dias h√°biles"})})]})]}),e.jsxs("div",{className:"bg-[#F7F9FB] rounded-xl shadow-lg p-6 col-span-2 h-max",children:[e.jsx("h3",{className:"text-2xl font-bold pb-6",children:"Resumen de compra"}),e.jsx("div",{className:"space-y-6 border-b-2 pb-6",children:n.map((o,t)=>e.jsx("div",{className:"rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"bg-white p-2 rounded-xl",children:e.jsx("img",{src:`/storage/images/item/${o.image}`,alt:o.name,className:"w-20 h-20 object-cover rounded  "})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-lg mb-2",children:o.name}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Marca:"," ",e.jsx("span",{className:"customtext-neutral-dark",children:o.brand.name})]}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Cantidad:"," ",e.jsxs("span",{className:"customtext-neutral-dark",children:[o.quantity," "]})]}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["SKU:"," ",e.jsx("span",{className:"customtext-neutral-dark",children:o.sku})]})]})]})},o.id))}),e.jsxs("div",{className:"space-y-4 mt-6",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Subtotal"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",g(p)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"IGV"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",g(h)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Env√≠o"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",g(S)]})]}),e.jsx("div",{className:"py-3 border-y-2 mt-6",children:e.jsxs("div",{className:"flex justify-between font-bold text-[20px] items-center",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["S/ ",g(x)]})]})}),e.jsxs("div",{className:"space-y-2 pt-4",children:[e.jsxs(I,{onClick:U,children:[" ","Continuar"]}),e.jsxs(z,{onClick:d,children:[" ","Cancelar"]})]}),e.jsx("div",{children:e.jsxs("p",{className:"text-sm customtext-neutral-dark",children:["Al realizar tu pedido, aceptas los",e.jsx("a",{className:"customtext-primary font-bold",children:"T√©rminos y Condiciones"}),", y que nosotros usaremos sus datos personales de acuerdo con nuestra",e.jsx("a",{className:"customtext-primary font-bold",children:"Pol√≠tica de Privacidad"}),"."]})})]})]})]})}function ee({cart:n,code:c,delivery:m}){const l=(n.reduce((p,h)=>{const x=h.final_price;return p+x*h.quantity},0)/1.18).toFixed(2),f=(l*.18).toFixed(2),d=parseFloat(l)+parseFloat(f)+parseFloat(m);return e.jsx("div",{className:"mx-auto",children:e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("h2",{className:"text-[20px] customtext-neutral-light",children:"Gracias por tu compra üéâ"}),e.jsx("p",{className:"customtext-neutral-dark text-5xl font-semibold",children:"Tu orden ha sido recibida"}),e.jsxs("div",{className:"py-4",children:[e.jsx("div",{className:" customtext-neutral-light",children:"C√≥digo de pedido"}),e.jsx("div",{className:"customtext-neutral-dark text-lg font-semibold",children:`#${c}`})]}),e.jsxs("div",{className:"space-y-4 max-w-lg bg-[#F7F9FB] mx-auto p-8 rounded-xl",children:[e.jsx("div",{className:"space-y-6 border-b-2 pb-6",children:n.map((p,h)=>e.jsx("div",{className:"rounded-lg",children:e.jsxs("div",{className:"flex   gap-4",children:[e.jsx("div",{className:"bg-white p-2 rounded-xl w-max",children:e.jsx("img",{src:`/storage/images/item/${p.image}`,alt:p.name,className:"w-20 h-20 object-cover rounded  "})}),e.jsxs("div",{className:" text-start",children:[e.jsx("h3",{className:"font-medium text-lg mb-2",children:p.name}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Marca: ",e.jsx("span",{className:"customtext-neutral-dark",children:p.brand.name})]}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Cantidad: ",e.jsxs("span",{className:"customtext-neutral-dark",children:[p.quantity," "]})]}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["SKU: ",e.jsx("span",{className:"customtext-neutral-dark",children:p.sku})]})]})]})},h))}),e.jsxs("div",{className:"space-y-4 mt-6",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Subtotal"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",g(l)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"IGV"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",g(f)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Env√≠o"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",g(m)]})]}),e.jsx("div",{className:"py-3 border-y-2 mt-6",children:e.jsxs("div",{className:"flex justify-between font-bold text-[20px] items-center",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["S/ ",g(d)]})]})})]}),e.jsx("div",{className:"pt-3",children:e.jsx(I,{href:"/catalogo",children:"  Seguir Comprando"})})]})]})})})}function Ce({cart:n,setCart:c,user:m}){const[r,l]=i.useState(1),d=(n.reduce((u,N)=>{const w=N.final_price;return u+w*N.quantity},0)/1.18).toFixed(2),p=(d*.18).toFixed(2),[h,x]=i.useState(0),s=parseFloat(d)+parseFloat(p)+parseFloat(h),[y,S]=i.useState([]),[a,b]=i.useState([]),[C,v]=i.useState([]);return i.useEffect(()=>{console.log("üîÑ CheckoutSteps: Sincronizando carrito con localStorage...");const u=j.Local.get(`${q.APP_CORRELATIVE}_cart`)||[];console.log("üì¶ CheckoutSteps: Carrito desde localStorage:",u),u.length>0&&JSON.stringify(u)!==JSON.stringify(n)&&(console.log("‚úÖ CheckoutSteps: Actualizando carrito desde localStorage"),c(u))},[]),i.useEffect(()=>{const u=N=>{console.log("üì¢ CheckoutSteps: Carrito actualizado:",N.detail);const w=j.Local.get(`${q.APP_CORRELATIVE}_cart`)||[];console.log("üîÑ CheckoutSteps: Cargando carrito actualizado:",w),c(w)};return window.addEventListener("cartUpdated",u),()=>{window.removeEventListener("cartUpdated",u)}},[c]),i.useEffect(()=>{const u=document.createElement("script");return u.src="https://checkout.culqi.com/js/v4",u.async=!0,u.onload=()=>{console.log("‚úÖ Culqi cargado correctamente."),window.culqi=function(){window.Culqi.token?console.log("‚úÖ Token recibido:",window.Culqi.token.id):window.Culqi.order?console.log("‚úÖ Orden recibida:",window.Culqi.order):console.error("‚ùå Error en Culqi:",window.Culqi.error)}},document.body.appendChild(u),()=>{document.body.removeChild(u)}},[]),e.jsx("div",{className:"min-h-screen  py-12 px-primary 2xl:px-0 2xl:max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-white   p-8 rounded-xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between max-w-3xl mx-auto",children:[e.jsx("div",{className:`text-sm ${r===1?"customtext-primary font-medium":"customtext-neutral-dark"}`,children:"1. Carrito de compra"}),e.jsx("div",{className:`text-sm ${r===2?"customtext-primary font-medium":"customtext-neutral-dark"}`,children:"2. Detalles de env√≠o"}),e.jsx("div",{className:`text-sm ${r===3?"customtext-primary font-medium":"customtext-neutral-dark"}`,children:"3. Orden confirmada"})]}),e.jsx("div",{className:"mt-4 h-1 max-w-3xl mx-auto bg-gray-200",children:e.jsx("div",{className:"h-1 bg-primary transition-all duration-500",style:{width:`${(r-1)/2*100}%`}})})]}),r===1&&e.jsx(Q,{cart:n,setCart:c,onContinue:()=>l(2),subTotal:d,envio:h,igv:p,totalFinal:s}),r===2&&e.jsx(Z,{setCode:b,setDelivery:v,cart:n,setSale:S,setCart:c,onContinue:()=>l(3),noContinue:()=>l(1),subTotal:d,envio:h,setEnvio:x,igv:p,totalFinal:s,user:m}),r===3&&e.jsx(ee,{code:a,delivery:C,cart:y,subTotal:d,envio:h,igv:p,totalFinal:s})]})})}export{Ce as default};
