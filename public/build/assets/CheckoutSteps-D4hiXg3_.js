import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as i}from"./index-BOnQTV8N.js";import{N as g}from"./Number2Currency-e57Tgsuk.js";import{m as y}from"./main-Bp3JhiuO.js";import{G as L}from"./Global-BM4Id4Pw.js";import{B as O,a as K,D as le}from"./DeliveryPricesRest-CepPhj8K.js";import{C as ce}from"./CardItem-CdbVCrTF.js";import{u as R,S as I}from"./SelectForm-CoB1IHa7.js";import{I as F}from"./InputForm-BW2Lnisr.js";import{c as X}from"./createLucideIcon-DfjclApS.js";import{C as $}from"./check-D5vaIe6v.js";import{S as de}from"./smartphone-BHF2PZKl.js";import{B as me}from"./building-2-DSFvhCB-.js";import{U as pe}from"./upload-GO9GDST_.js";import"./index-yBjzXJbu.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./___vite-browser-external_commonjs-proxy-DDYoOVPM.js";import"./book-C1IPlXSj.js";import"./minus-Db6MFKEO.js";import"./plus-CTIomuuF.js";import"./trash-2-DU7LB6-f.js";import"./chevron-down-uIVDLcM-.js";import"./search-BQ59Robe.js";/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=X("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=X("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);function xe({cart:n,setCart:l,onContinue:o,subTotal:d,envio:c,igv:b,totalFinal:m}){console.log("üõí CartStep: Cart received:",n);const u=p=>{typeof p=="function"?l(t=>{const v=p(t);return y.Local.set(`${L.APP_CORRELATIVE}_cart`,v),console.log("üõí CartStep: Carrito actualizado en localStorage:",v.length,"items"),v}):(l(p),y.Local.set(`${L.APP_CORRELATIVE}_cart`,p),console.log("üõí CartStep: Carrito actualizado en localStorage:",p.length,"items"))},f=n.reduce((p,t)=>{const v=t.price||0,P=t.final_price||t.price||0,a=t.quantity||1;return v>P?p+(v-P)*a:p},0);return e.jsxs("div",{className:"grid lg:grid-cols-5 gap-8",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsx("div",{className:"space-y-6",children:n.map((p,t)=>e.jsx(ce,{...p,setCart:u},t))})}),e.jsxs("div",{className:"bg-[#F7F9FB] rounded-xl shadow-lg p-6 col-span-2 h-max",children:[e.jsx("h3",{className:"text-2xl font-bold pb-6",children:"Resumen de compra"}),e.jsxs("div",{className:"space-y-4",children:[f>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-600 font-medium",children:"Ahorros totales"}),e.jsxs("span",{className:"font-semibold text-green-600",children:["-S/ ",g(f)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Subtotal"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",g(d)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"IGV"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",g(b)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Env√≠o"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",g(c)]})]}),e.jsx("div",{className:"py-3 border-y-2 mt-6",children:e.jsxs("div",{className:"flex justify-between font-bold text-[20px] items-center",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["S/ ",g(m)]})]})}),e.jsxs("div",{className:"space-y-2 pt-4",children:[e.jsx(O,{onClick:o,children:"  Continuar"}),e.jsx(K,{href:"/",children:" Cancelar"})]}),e.jsx("div",{children:e.jsxs("p",{className:"text-sm customtext-neutral-dark",children:["Al realizar tu pedido, aceptas los¬†",e.jsx("a",{className:"customtext-primary font-bold",children:"T√©rminos y Condiciones"}),", y que nosotros usaremos sus datos personales de acuerdo con nuestra¬†",e.jsx("a",{className:"customtext-primary font-bold",children:"Pol√≠tica de Privacidad"}),"."]})})]})]})]})}function he(){let n="";for(let l=0;l<12;l++){const o=Math.floor(Math.random()*10);n+=o}return n}const ue=n=>new Promise((l,o)=>{try{console.log(n);const d=he(n.email);console.log(d),window.Culqi.publicKey="pk_test_f4d42a7b5073e8df",window.Culqi.settings({title:"Sala Fabulosa",email:n.email,currency:"PEN",amount:n.amount*100,order:`${d}`}),console.log(window.Culqi.settings),window.Culqi.options({lang:"es",installments:!1,paymentMethods:{tarjeta:!0,yape:!0,bancaMovil:!0,agente:!0,billetera:!0,cuotealo:!0},style:{logo:"/assets/resources/logo.png",bannerColor:"#311609",buttonBackground:"#311609"}}),window.Culqi.open(),window.culqi=async function(){try{if(!window.Culqi.token){o("No se obtuvo un token de Culqi");return}const c=window.Culqi.token.id;console.log("‚úÖ Token generado:",c),n={...n,token:c,orderNumber:d},console.log("_request actualizado",n);const{status:b,result:m}=await y.Fetch("./api/pago",{method:"POST",body:JSON.stringify(n)});b||console.log((m==null?void 0:m.message)||"Error en el pago"),window.Culqi.close(),y.Notify.add({icon:"/assets/img/icon.svg",title:"Pago Exitoso",body:"El pago se proces√≥ correctamente.",type:"success"}),l(m)}catch(c){y.Notify.add({icon:"/assets/img/icon.svg",title:"Error en el Pago",body:c.message,type:"danger"}),o(c.message||"Error en el pago")}},document.addEventListener("culqi.error",function(c){var b,m;y.Notify.add({icon:"/assets/img/icon.svg",title:"Error en Culqi",body:((b=c.detail)==null?void 0:b.message)||"Error desconocido",type:"danger"}),o(((m=c.detail)==null?void 0:m.message)||"Error desconocido")})}catch(d){y.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:d.message,type:"danger"}),o("Error en la integraci√≥n con Culqi")}}),ge=async n=>{var l;try{const o=await fetch("/api/payments/mercadopago",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":(l=document.querySelector('meta[name="csrf-token"]'))==null?void 0:l.getAttribute("content")},body:JSON.stringify(n)});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(o){throw console.error("Error processing MercadoPago payment:",o),o}},ye=async n=>{var l;try{const o=await fetch("/api/payments/manual",{method:"POST",headers:{"X-CSRF-TOKEN":(l=document.querySelector('meta[name="csrf-token"]'))==null?void 0:l.getAttribute("content")},body:n});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(o){throw console.error("Error processing manual payment:",o),o}},H=({title:n,description:l,selected:o,onSelect:d,disabled:c})=>e.jsxs("div",{className:`flex w-full items-center gap-3 p-4 border rounded-xl cursor-pointer transition-all duration-300 customtext-neutral-dark 
                }`,onClick:d,children:[e.jsx("div",{className:`w-5 h-5 border-2 rounded-full flex items-center justify-center ${o?"border-primary":""}`,children:o&&e.jsx("div",{className:"w-3 h-3 bg-primary rounded-full"})}),e.jsxs("div",{className:"customtext-neutral-light",children:[e.jsx("h4",{className:"text-sm ",children:n}),e.jsx("p",{className:"text-xs",children:l})]})]});function je({cart:n,setSale:l,setCode:o,setDelivery:d,setCart:c,onContinue:b,noContinue:m,subTotal:u,igv:f,totalFinal:p,user:t,setEnvio:v,envio:P}){const[a,N]=i.useState({name:(t==null?void 0:t.name)||"",lastname:(t==null?void 0:t.lastname)||"",email:(t==null?void 0:t.email)||"",department:(t==null?void 0:t.department)||"",province:(t==null?void 0:t.province)||"",district:(t==null?void 0:t.district)||"",address:(t==null?void 0:t.address)||"",number:(t==null?void 0:t.number)||"",comment:(t==null?void 0:t.comment)||"",reference:(t==null?void 0:t.reference)||"",shippingOption:"delivery",paymentMethod:"culqi"}),[k,z]=i.useState(null),[h,S]=i.useState(null),[A,be]=i.useState(0),[Ne,W]=i.useState([]),[ve,Q]=i.useState(!0),M=r=>{const{name:s,value:x}=r.target;N(j=>({...j,[s]:x}))},_=r=>{N(s=>({...s,paymentMethod:r})),(r==="culqi"||r==="mercadopago")&&(z(null),S(null))},Z=r=>{const s=r.target.files[0];if(s){if(!["image/jpeg","image/jpg","image/png","application/pdf"].includes(s.type)){y.Notify.add({icon:"/assets/img/icon.svg",title:"Archivo no v√°lido",body:"Solo se permiten im√°genes (JPG, PNG) o archivos PDF",type:"danger"});return}if(s.size>5*1024*1024){y.Notify.add({icon:"/assets/img/icon.svg",title:"Archivo muy grande",body:"El archivo no debe superar los 5MB",type:"danger"});return}if(z(s),s.type.startsWith("image/")){const j=new FileReader;j.onload=w=>S(w.target.result),j.readAsDataURL(s)}else S(null)}},[C,ee]=i.useState(""),[E,D]=i.useState(""),[T,B]=i.useState(""),[ae,se]=i.useState([]),[te,re]=i.useState([]),[ne,G]=i.useState([]),[Ce,we]=i.useState(0);i.useEffect(()=>{oe()},[]);const oe=async()=>{try{const s=await(await fetch("/api/payments/methods")).json();s.status&&(W(s.methods),s.methods.length>0&&N(x=>({...x,paymentMethod:s.methods[0].slug})))}catch(r){console.error("Error fetching payment methods:",r)}finally{Q(!1)}};i.useEffect(()=>{const r=[...new Set(R.map(s=>s.departamento))];se(r)},[]),i.useEffect(()=>{if(C){const r=[...new Set(R.filter(s=>s.departamento===C).map(s=>s.provincia))];re(r),D(""),B(""),G([]),N(s=>({...s,department:C,province:"",district:""}))}},[C]),i.useEffect(()=>{if(E){const r=R.filter(s=>s.departamento===C&&s.provincia===E).map(s=>s.distrito);G(r),B(""),N(s=>({...s,province:E,district:""}))}},[E]),i.useEffect(()=>{T&&(N(s=>({...s,district:T})),(async()=>{try{const s=await le.getShippingCost({department:C,district:T});v(s.data.price),g(s.data.price)>0?V("express"):V("free")}catch(s){console.error("Error fetching shipping cost:",s),alert("No se pudo obtener el costo de env√≠o.")}})())},[T]);const ie=async r=>{if(r.preventDefault(),!t){y.Notify.add({icon:"/assets/img/icon.svg",title:"Iniciar Sesi√≥n",body:"Se requiere que inicie sesi√≥n para realizar la compra",type:"danger"});return}if(!a.department||!a.province||!a.district||!a.name||!a.lastname||!a.email||!a.address||!a.reference){y.Notify.add({icon:"/assets/img/icon.svg",title:"Error en el Formulario",body:"Completar los datos de env√≠o",type:"danger"});return}if((a.paymentMethod==="yape"||a.paymentMethod==="transferencia")&&!k){y.Notify.add({icon:"/assets/img/icon.svg",title:"Comprobante requerido",body:"Debe subir el comprobante de pago para este m√©todo",type:"danger"});return}const s={user_id:(t==null?void 0:t.id)||"",name:(a==null?void 0:a.name)||"",lastname:(a==null?void 0:a.lastname)||"",fullname:`${a==null?void 0:a.name} ${a==null?void 0:a.lastname}`,email:(a==null?void 0:a.email)||"",phone:"",country:"Per√∫",department:C||"",province:E||"",district:T||"",ubigeo:null,address:(a==null?void 0:a.address)||"",number:(a==null?void 0:a.number)||"",comment:(a==null?void 0:a.comment)||"",reference:(a==null?void 0:a.reference)||"",amount:p||0,delivery:P,cart:n,payment_method:a.paymentMethod};try{let x;switch(a.paymentMethod){case"culqi":if(!window.Culqi){console.error("‚ùå Culqi a√∫n no se ha cargado.");return}x=await ue(s);break;case"mercadopago":x=await ge(s);break;case"yape":case"transferencia":const w=new FormData;Object.keys(s).forEach(q=>{Array.isArray(s[q])?w.append(q,JSON.stringify(s[q])):w.append(q,s[q])}),w.append("payment_proof",k),x=await ye(w);break;default:throw new Error("M√©todo de pago no v√°lido")}const j=x;j.status?(l(j.sale),d(j.delivery),o(j.code),c([]),y.Notify.add({icon:"/assets/img/icon.svg",title:"¬°Pedido procesado!",body:a.paymentMethod==="culqi"||a.paymentMethod==="mercadopago"?"Su pago ha sido procesado exitosamente":"Su pedido est√° pendiente de validaci√≥n del comprobante",type:"success"}),b()):y.Notify.add({icon:"/assets/img/icon.svg",title:"Error en el Pago",body:j.message||"El pago ha sido rechazado",type:"danger"})}catch(x){console.log(x),y.Notify.add({icon:"/assets/img/icon.svg",title:"Error en el Pago",body:"No se pudo procesar el pago",type:"danger"})}},[J,V]=i.useState("free");return e.jsxs("div",{className:"grid lg:grid-cols-5 gap-8",children:[e.jsxs("div",{className:"lg:col-span-3",children:[e.jsxs("form",{className:"space-y-6",onSubmit:r=>r.preventDefault(),children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(F,{type:"text",label:"Nombres",name:"name",value:a.name,onChange:M,placeholder:"Nombres"}),e.jsx(F,{label:"Apellidos",type:"text",name:"lastname",value:a.lastname,onChange:M,placeholder:"Apellidos"})]}),e.jsx(F,{label:"Correo electr√≥nico",type:"email",name:"email",value:a.email,onChange:M,placeholder:"Ej. hola@gmail.com"}),e.jsx(I,{label:"Departamento",options:ae,placeholder:"Selecciona un Departamento",onChange:r=>{ee(r),N(s=>({...s,department:C}))}}),e.jsx(I,{disabled:!C,label:"Provincia",options:te,placeholder:"Selecciona una Provincia",onChange:r=>{D(r),N(s=>({...s,province:E}))}}),e.jsx(I,{disabled:!E,label:"Distrito",options:ne,placeholder:"Selecciona un Distrito",onChange:r=>{B(r),N(s=>({...s,district:T}))}}),e.jsx(F,{label:"Avenida / Calle / Jir√≥n",type:"text",name:"address",value:a.address,onChange:M,placeholder:"Ingresa el nombre de la calle"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(F,{label:"N√∫mero",type:"text",name:"number",value:a.number,onChange:M,placeholder:"Ingresa el n√∫mero de la calle"}),e.jsx(F,{label:"Dpto./ Interior/ Piso/ Lote/ Bloque (opcional)",type:"text",name:"comment",value:a.comment,onChange:M,placeholder:"Ej. Casa 3, Dpto 101"})]}),e.jsx(F,{label:"Referencia",type:"text",name:"reference",value:a.reference,onChange:M,placeholder:"Ejem. Altura de la avenida..."}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"M√©todo de Pago"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:`border-2 rounded-xl p-4 cursor-pointer transition-all duration-200 ${a.paymentMethod==="culqi"?"border-primary bg-primary/5":"border-gray-200 hover:border-gray-300"}`,onClick:()=>_("culqi"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${a.paymentMethod==="culqi"?"bg-primary text-white":"bg-gray-100"}`,children:e.jsx(U,{size:20})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium",children:"Tarjeta de Cr√©dito/D√©bito"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Visa, Mastercard"})]}),a.paymentMethod==="culqi"&&e.jsx($,{size:20,className:"text-primary"})]})}),e.jsx("div",{className:`border-2 rounded-xl p-4 cursor-pointer transition-all duration-200 ${a.paymentMethod==="mercadopago"?"border-primary bg-primary/5":"border-gray-200 hover:border-gray-300"}`,onClick:()=>_("mercadopago"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${a.paymentMethod==="mercadopago"?"bg-primary text-white":"bg-gray-100"}`,children:e.jsx(U,{size:20})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium",children:"MercadoPago"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Pago online seguro"})]}),a.paymentMethod==="mercadopago"&&e.jsx($,{size:20,className:"text-primary"})]})}),e.jsx("div",{className:`border-2 rounded-xl p-4 cursor-pointer transition-all duration-200 ${a.paymentMethod==="yape"?"border-primary bg-primary/5":"border-gray-200 hover:border-gray-300"}`,onClick:()=>_("yape"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${a.paymentMethod==="yape"?"bg-primary text-white":"bg-gray-100"}`,children:e.jsx(de,{size:20})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium",children:"Yape"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Pago m√≥vil"})]}),a.paymentMethod==="yape"&&e.jsx($,{size:20,className:"text-primary"})]})}),e.jsx("div",{className:`border-2 rounded-xl p-4 cursor-pointer transition-all duration-200 ${a.paymentMethod==="transferencia"?"border-primary bg-primary/5":"border-gray-200 hover:border-gray-300"}`,onClick:()=>_("transferencia"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${a.paymentMethod==="transferencia"?"bg-primary text-white":"bg-gray-100"}`,children:e.jsx(me,{size:20})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium",children:"Transferencia Bancaria"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Dep√≥sito o transferencia"})]}),a.paymentMethod==="transferencia"&&e.jsx($,{size:20,className:"text-primary"})]})})]}),a.paymentMethod==="yape"&&e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-xl p-4",children:[e.jsx("h4",{className:"font-medium text-purple-800 mb-2",children:"Instrucciones para Yape:"}),e.jsxs("div",{className:"text-sm text-purple-700 space-y-2",children:[e.jsxs("p",{children:["1. Realiza el Yape al n√∫mero: ",e.jsx("strong",{children:"+51 999 888 777"})]}),e.jsxs("p",{children:["2. Monto: ",e.jsxs("strong",{children:["S/ ",g(p)]})]}),e.jsx("p",{children:"3. Toma captura del comprobante"}),e.jsx("p",{children:"4. Sube la imagen abajo"})]})]}),a.paymentMethod==="transferencia"&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:[e.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Datos para Transferencia:"}),e.jsxs("div",{className:"text-sm text-blue-700 space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Banco:"})," BCP"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Cuenta Corriente:"})," 123-456789-0-12"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"CCI:"})," 00212312345678901234"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Titular:"})," BananaLab SAC"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Monto:"})," S/ ",g(p)]}),e.jsx("p",{className:"mt-2 font-medium",children:"Sube el voucher de la transferencia abajo"})]})]}),(a.paymentMethod==="yape"||a.paymentMethod==="transferencia")&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Comprobante de Pago *"}),e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(pe,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("label",{htmlFor:"payment-proof",className:"cursor-pointer",children:[e.jsx("span",{className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary-dark transition-colors",children:"Subir Archivo"}),e.jsx("input",{id:"payment-proof",type:"file",className:"hidden",accept:"image/*,.pdf",onChange:Z})]}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"PNG, JPG o PDF hasta 5MB"})]})]})}),k&&e.jsxs("div",{className:"mt-4 p-4 bg-green-50 border border-green-200 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx($,{className:"text-green-600",size:20}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-green-800",children:["Archivo cargado: ",k.name]}),e.jsxs("p",{className:"text-xs text-green-600",children:[(k.size/1024/1024).toFixed(2)," MB"]})]})]}),h&&e.jsx("div",{className:"mt-3",children:e.jsx("img",{src:h,alt:"Preview",className:"max-w-full h-32 object-contain rounded-lg border"})})]})]})]})]}),e.jsxs("div",{className:"flex gap-4 mt-4",children:[e.jsx(H,{title:"Env√≠o gratis",description:"Entrega entre 3 a 10 d√≠as h√°biles",selected:J==="free"}),e.jsx(H,{title:"Delivery",description:"Delivery 24 horas",selected:J==="express"})]}),e.jsxs("div",{className:"flex gap-4 mt-6 bg-[#F7F9FB] p-3 rounded-xl",children:[e.jsx("div",{className:"w-5",children:e.jsx(Y,{className:"customtext-primary",width:"20px"})}),e.jsxs("div",{className:"text-xs font-medium customtext-neutral-dark flex flex-col gap-2",children:[e.jsx("p",{children:"Solo Lima Metropolitana: Dentro de las 24 horas despu√©s de efectuado el pago, solo algunos distritos de Lima Metropolitana."}),e.jsxs("p",{children:[" ","Distritos No incluidos: Santa Mar√≠a del Mar, Pucusana, San Bartolo, Punta Hermosa, Lur√≠n, Pachacamac, Chorrillos, Villa el Salvador, Villa Mar√≠a del Triunfo, San Juan de Miraflores, Cieneguilla, Ate, Chosica, Huaycan, San Juan de Lurigancho (hasta el Metro), Anc√≥n, Santa Rosa, Carabayllo, Puente Piedra."]}),e.jsxs("p",{children:[" ","Same Day: Solo para compras efectuadas hasta las 1pm del d√≠a."]})]})]}),e.jsxs("div",{className:"flex gap-4 mt-4 bg-[#F7F9FB] p-3 rounded-xl",children:[e.jsx("div",{className:"w-5",children:e.jsx(Y,{className:"customtext-primary",width:"20px"})}),e.jsx("div",{className:"text-xs font-medium customtext-neutral-dark flex flex-col gap-2",children:e.jsx("p",{children:"Lima: 3 a 4 dias h√°biles | Provincia: de 4 a 10 dias h√°biles"})})]})]}),e.jsxs("div",{className:"bg-[#F7F9FB] rounded-xl shadow-lg p-6 col-span-2 h-max",children:[e.jsx("h3",{className:"text-2xl font-bold pb-6",children:"Resumen de compra"}),e.jsx("div",{className:"space-y-6 border-b-2 pb-6",children:n.map((r,s)=>{var x,j;return e.jsx("div",{className:"rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"bg-white p-2 rounded-xl",children:e.jsx("img",{src:r.type==="custom_album"?`/storage/images/item_preset/${r.image}`:`/storage/images/item/${r.image}`,alt:r.name,className:"w-20 h-20 object-cover rounded"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-lg mb-2",children:r.name}),r.type==="custom_album"?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Tipo:"," ",e.jsx("span",{className:"customtext-neutral-dark",children:"√Ålbum Personalizado"})]}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["P√°ginas:"," ",e.jsx("span",{className:"customtext-neutral-dark",children:((x=r.album_data)==null?void 0:x.pages_count)||"N/A"})]})]}):e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Marca:"," ",e.jsx("span",{className:"customtext-neutral-dark",children:((j=r.brand)==null?void 0:j.name)||"Sin marca"})]}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Cantidad:"," ",e.jsx("span",{className:"customtext-neutral-dark",children:r.quantity||1})]})]})]})},r.id)})}),e.jsxs("div",{className:"space-y-4 mt-6",children:[(()=>{const r=n.reduce((s,x)=>{const j=x.price||0,w=x.final_price||x.price||0,q=x.quantity||1;return j>w?s+(j-w)*q:s},0);return r>0?e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-600 font-medium",children:"Ahorros totales"}),e.jsxs("span",{className:"font-semibold text-green-600",children:["-S/ ",g(r)]})]}):null})(),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Subtotal"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",g(u)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"IGV"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",g(f)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Env√≠o"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",g(P)]})]}),e.jsx("div",{className:"py-3 border-y-2 mt-6",children:e.jsxs("div",{className:"flex justify-between font-bold text-[20px] items-center",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["S/ ",g(p)]})]})}),e.jsxs("div",{className:"space-y-2 pt-4",children:[e.jsx(O,{onClick:ie,children:(()=>{switch(a.paymentMethod){case"culqi":return"Pagar con Tarjeta";case"mercadopago":return"Pagar con MercadoPago";case"yape":return"Confirmar Pago Yape";case"transferencia":return"Confirmar Transferencia";default:return"Continuar"}})()}),e.jsx(K,{onClick:m,children:"Cancelar"})]}),e.jsx("div",{children:e.jsxs("p",{className:"text-sm customtext-neutral-dark",children:["Al realizar tu pedido, aceptas los",e.jsx("a",{className:"customtext-primary font-bold",children:"T√©rminos y Condiciones"}),", y que nosotros usaremos sus datos personales de acuerdo con nuestra",e.jsx("a",{className:"customtext-primary font-bold",children:"Pol√≠tica de Privacidad"}),"."]})})]})]})]})}function fe({cart:n,code:l,delivery:o}){const c=(n.reduce((u,f)=>{const p=f.final_price;return u+p*f.quantity},0)/1.18).toFixed(2),b=(c*.18).toFixed(2),m=parseFloat(c)+parseFloat(b)+parseFloat(o);return e.jsx("div",{className:"mx-auto",children:e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("h2",{className:"text-[20px] customtext-neutral-light",children:"Gracias por tu compra üéâ"}),e.jsx("p",{className:"customtext-neutral-dark text-5xl font-semibold",children:"Tu orden ha sido recibida"}),e.jsxs("div",{className:"py-4",children:[e.jsx("div",{className:" customtext-neutral-light",children:"C√≥digo de pedido"}),e.jsx("div",{className:"customtext-neutral-dark text-lg font-semibold",children:`#${l}`})]}),e.jsxs("div",{className:"space-y-4 max-w-lg bg-[#F7F9FB] mx-auto p-8 rounded-xl",children:[e.jsx("div",{className:"space-y-6 border-b-2 pb-6",children:n.map((u,f)=>e.jsx("div",{className:"rounded-lg",children:e.jsxs("div",{className:"flex   gap-4",children:[e.jsx("div",{className:"bg-white p-2 rounded-xl w-max",children:e.jsx("img",{src:`/storage/images/item/${u.image}`,alt:u.name,className:"w-20 h-20 object-cover rounded  "})}),e.jsxs("div",{className:" text-start",children:[e.jsx("h3",{className:"font-medium text-lg mb-2",children:u.name}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Marca: ",e.jsx("span",{className:"customtext-neutral-dark",children:u.brand.name})]}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Cantidad: ",e.jsxs("span",{className:"customtext-neutral-dark",children:[u.quantity," "]})]}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["SKU: ",e.jsx("span",{className:"customtext-neutral-dark",children:u.sku})]})]})]})},f))}),e.jsxs("div",{className:"space-y-4 mt-6",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Subtotal"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",g(c)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"IGV"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",g(b)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Env√≠o"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",g(o)]})]}),e.jsx("div",{className:"py-3 border-y-2 mt-6",children:e.jsxs("div",{className:"flex justify-between font-bold text-[20px] items-center",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["S/ ",g(m)]})]})})]}),e.jsx("div",{className:"pt-3",children:e.jsx(O,{href:"/catalogo",children:"  Seguir Comprando"})})]})]})})})}function He({cart:n,setCart:l,user:o}){const[d,c]=i.useState(1),m=(n.reduce((h,S)=>{const A=S.final_price;return h+A*S.quantity},0)/1.18).toFixed(2),u=(m*.18).toFixed(2),[f,p]=i.useState(0),t=parseFloat(m)+parseFloat(u)+parseFloat(f),[v,P]=i.useState([]),[a,N]=i.useState([]),[k,z]=i.useState([]);return i.useEffect(()=>{console.log("üîÑ CheckoutSteps: Sincronizando carrito con localStorage...");const h=y.Local.get(`${L.APP_CORRELATIVE}_cart`)||[];console.log("üì¶ CheckoutSteps: Carrito desde localStorage:",h),h.length>0&&JSON.stringify(h)!==JSON.stringify(n)&&(console.log("‚úÖ CheckoutSteps: Actualizando carrito desde localStorage"),l(h))},[]),i.useEffect(()=>{const h=S=>{console.log("üì¢ CheckoutSteps: Carrito actualizado:",S.detail);const A=y.Local.get(`${L.APP_CORRELATIVE}_cart`)||[];console.log("üîÑ CheckoutSteps: Cargando carrito actualizado:",A),l(A)};return window.addEventListener("cartUpdated",h),()=>{window.removeEventListener("cartUpdated",h)}},[l]),i.useEffect(()=>{const h=document.createElement("script");return h.src="https://checkout.culqi.com/js/v4",h.async=!0,h.onload=()=>{console.log("‚úÖ Culqi cargado correctamente."),window.culqi=function(){window.Culqi.token?console.log("‚úÖ Token recibido:",window.Culqi.token.id):window.Culqi.order?console.log("‚úÖ Orden recibida:",window.Culqi.order):console.error("‚ùå Error en Culqi:",window.Culqi.error)}},document.body.appendChild(h),()=>{document.body.removeChild(h)}},[]),e.jsx("div",{className:"min-h-screen  py-12 px-primary 2xl:px-0 2xl:max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-white   p-8 rounded-xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between max-w-3xl mx-auto",children:[e.jsx("div",{className:`text-sm ${d===1?"customtext-primary font-medium":"customtext-neutral-dark"}`,children:"1. Carrito de compra"}),e.jsx("div",{className:`text-sm ${d===2?"customtext-primary font-medium":"customtext-neutral-dark"}`,children:"2. Detalles de env√≠o"}),e.jsx("div",{className:`text-sm ${d===3?"customtext-primary font-medium":"customtext-neutral-dark"}`,children:"3. Orden confirmada"})]}),e.jsx("div",{className:"mt-4 h-1 max-w-3xl mx-auto bg-gray-200",children:e.jsx("div",{className:"h-1 bg-primary transition-all duration-500",style:{width:`${(d-1)/2*100}%`}})})]}),d===1&&e.jsx(xe,{cart:n,setCart:l,onContinue:()=>c(2),subTotal:m,envio:f,igv:u,totalFinal:t}),d===2&&e.jsx(je,{setCode:N,setDelivery:z,cart:n,setSale:P,setCart:l,onContinue:()=>c(3),noContinue:()=>c(1),subTotal:m,envio:f,setEnvio:p,igv:u,totalFinal:t,user:o}),d===3&&e.jsx(fe,{code:a,delivery:k,cart:v,subTotal:m,envio:f,igv:u,totalFinal:t})]})})}export{He as default};
