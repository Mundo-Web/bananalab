var te=Object.defineProperty;var ne=(p,f,c)=>f in p?te(p,f,{enumerable:!0,configurable:!0,writable:!0,value:c}):p[f]=c;var x=(p,f,c)=>ne(p,typeof f!="symbol"?f+"":f,c);import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{B as oe}from"./Base-BEMHs2oE.js";import{S as D}from"./SwitchFormGroup-CPKgKErd.js";import{T as ae}from"./TextareaFormGroup-CgEriU3j.js";import{r as d}from"./index-BOnQTV8N.js";import{c as ce}from"./ReactAppend-DTVVXReZ.js";import{s as G}from"./DxBox-C2WMS09E.js";import{S as w}from"./ProductCard-CwyKCVe-.js";import{B as ie}from"./ModalImportItem-08p2KSos.js";import{M as le}from"./Modal-D318Q6e0.js";import{T as me}from"./Table-DaiyF0kF.js";import{I as de}from"./ImageFormGroup-BJgwOQgt.js";import{I as O}from"./InputFormGroup-BRr_So2P.js";import{S as pe}from"./SelectFormGroup-D5ZAG8Pz.js";import{D as H}from"./DxButton-CsjWvhyj.js";import{C as ue}from"./CreateReactScript-CrlrjA2p.js";import{N as fe}from"./Number2Currency-e57Tgsuk.js";import{R as he}from"./ReactAppend-D7S498fx.js";import"./index-yBjzXJbu.js";import"./Global-BM4Id4Pw.js";import"./tippy-react.esm-BktTnHXY.js";import"./index-DE3dzT5W.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./index-fNjTmf9T.js";/* empty css              */import"./Logout-BOnt0YF6.js";import"./main-Bp3JhiuO.js";import"./___vite-browser-external_commonjs-proxy-DDYoOVPM.js";import"./MenuItemContainer-BFMpZmqE.js";import"./index.esm-DFiNGWUA.js";/* empty css               */import"./General-BmbBKdsB.js";class ge extends ie{constructor(){super(...arguments);x(this,"path","admin/payment-methods");x(this,"hasFiles",!0);x(this,"toggleStatus",async c=>{var i;try{const n=await fetch(`/api/admin/payment-methods/${c}/toggle`,{method:"PATCH",headers:{"X-CSRF-TOKEN":(i=document.querySelector('meta[name="csrf-token"]'))==null?void 0:i.getAttribute("content")}}),o=await n.json();if(!n.ok)throw new Error((o==null?void 0:o.message)??"Error cambiando estado");return o}catch(n){throw console.error("Error en toggleStatus:",n.message),n}});x(this,"reorder",async c=>{var i;try{const n=await fetch("/api/admin/payment-methods/reorder",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":(i=document.querySelector('meta[name="csrf-token"]'))==null?void 0:i.getAttribute("content")},body:JSON.stringify({methods:c})}),o=await n.json();if(!n.ok)throw new Error((o==null?void 0:o.message)??"Error reordenando métodos");return o}catch(n){throw console.error("Error en reorder:",n.message),n}});x(this,"getTemplates",async()=>{try{const c=await fetch("/api/admin/payment-methods/templates"),i=await c.json();if(!c.ok)throw new Error((i==null?void 0:i.message)??"Error obteniendo plantillas");return i}catch(c){throw console.error("Error en getTemplates:",c.message),c}});x(this,"store",async c=>{var i;try{const n=await fetch(`/api/${this.path}`,{method:"POST",headers:{"X-CSRF-TOKEN":(i=document.querySelector('meta[name="csrf-token"]'))==null?void 0:i.getAttribute("content")},body:c}),o=await n.json();if(!n.ok)throw new Error((o==null?void 0:o.message)??"Error creando método de pago");return o}catch(n){throw console.error("Error en store:",n.message),n}});x(this,"update",async c=>{var i;try{const n=c.get("id");if(!n)throw new Error("ID es requerido para actualizar");c.append("_method","PUT");const o=await fetch(`/api/${this.path}/${n}`,{method:"POST",headers:{"X-CSRF-TOKEN":(i=document.querySelector('meta[name="csrf-token"]'))==null?void 0:i.getAttribute("content")},body:c}),g=await o.json();if(!o.ok)throw new Error((g==null?void 0:g.message)??"Error actualizando método de pago");return g}catch(n){throw console.error("Error en update:",n.message),n}});x(this,"destroy",async c=>{var i;try{const n=await fetch(`/api/${this.path}/${c}`,{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":(i=document.querySelector('meta[name="csrf-token"]'))==null?void 0:i.getAttribute("content")}}),o=await n.json();if(!n.ok)throw new Error((o==null?void 0:o.message)??"Error eliminando método de pago");return o}catch(n){throw console.error("Error en destroy:",n.message),n}});x(this,"list",async c=>{var i;try{const n=await fetch(`/api/${this.path}/paginate`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":(i=document.querySelector('meta[name="csrf-token"]'))==null?void 0:i.getAttribute("content")},body:JSON.stringify(c)}),o=await n.json();if(!n.ok)throw new Error((o==null?void 0:o.message)??"Error obteniendo métodos de pago");return o}catch(n){throw console.error("Error en list:",n.message),n}})}}const T=new ge,xe=()=>{const p=d.useRef(),f=d.useRef(),c=d.useRef(),i=d.useRef(),n=d.useRef(),o=d.useRef(),g=d.useRef(),E=d.useRef(),_=d.useRef(),R=d.useRef(),S=d.useRef(),b=d.useRef(),k=d.useRef(),I=d.useRef({}),[N,U]=d.useState(!1),[h,Q]=d.useState({}),[je,B]=d.useState("gateway"),[q,P]=d.useState(""),[j,X]=d.useState(null);d.useEffect(()=>{z()},[]);const z=async()=>{try{const r=await T.getTemplates();r.status&&Q(r.templates)}catch(r){console.error("Error loading templates:",r)}},L=r=>{X(r||null),U(!!(r!=null&&r.id)),console.log("Opening modal with data:",r);const s=(r==null?void 0:r.template_key)||"",t=(r==null?void 0:r.configuration)||{};console.log("Setting template key to:",s,"and type to:",(r==null?void 0:r.type)||"gateway"),console.log("Configuration data from backend:",t),I.current=t,c.current&&(c.current.value=(r==null?void 0:r.id)||""),i.current&&(i.current.value=(r==null?void 0:r.name)||""),n.current&&(n.current.value=(r==null?void 0:r.display_name)||""),o.current&&(o.current.value=(r==null?void 0:r.description)||""),E.current&&(E.current.checked=(r==null?void 0:r.is_active)??!0),_.current&&(_.current.checked=(r==null?void 0:r.requires_proof)??!1),R.current&&(R.current.value=(r==null?void 0:r.fee_percentage)||0),S.current&&(S.current.value=(r==null?void 0:r.fee_fixed)||0),k.current&&(k.current.value=(r==null?void 0:r.sort_order)||0),b.current&&(b.current.value=null,b.image&&(b.image.src=r!=null&&r.icon?`/storage/payment_icons/${r.icon}`:"/storage/images/item/undefined")),$(f.current).modal("show"),setTimeout(()=>{B((r==null?void 0:r.type)||"gateway"),g.current&&$(g.current).val((r==null?void 0:r.type)||"gateway").trigger("change"),s&&(P(s),console.log("Template key set to:",s,"triggering field generation..."))},300),setTimeout(()=>{s&&h[s]&&t&&(console.log("Attempting to populate config fields with data:",t),C(s,t))},1200),setTimeout(()=>{const a=document.getElementById("instructions-preview-container");if(a){const m=h[s];m&&m.instructions?a.style.display="block":a.style.display="none"}},1300)},C=(r,s={})=>{const t=h[r];if(!t||!t.config){console.warn("Template or config not found for templateKey:",r);return}console.log("Updating config fields for template:",r,"with config:",s);const a=(m=0)=>{let u=!0;if(Object.keys(t.config).forEach(l=>{document.getElementById(`config_${l}`)||(u=!1,console.warn(`Element config_${l} not found in DOM (attempt ${m+1})`))}),!u){m<15?(console.log(`Not all fields found, retrying in 200ms... (attempt ${m+1}/15)`),setTimeout(()=>a(m+1),200)):console.error("Max retries reached. Some configuration fields could not be found.");return}console.log("All config fields found, updating values..."),Object.keys(t.config).forEach(l=>{const v=document.getElementById(`config_${l}`);if(v){const y=s[l]||t.config[l].default||"";if(console.log(`Setting field ${l} to:`,y),v.type==="checkbox")v.checked=!!y;else if(v.type==="file"){const A=document.getElementById(`config_${l}_info`),F=document.getElementById(`config_${l}_preview`);A&&(y&&y!==""?(A.innerHTML=`<small class="text-success">✅ Archivo actual: ${y}</small>`,F&&t.config[l].accept&&t.config[l].accept.includes("image")&&(F.src=`/storage/payment_config/${y}`,F.style.display="block",console.log(`Showing image preview for ${l}:`,`/storage/payment_config/${y}`))):(A.innerHTML='<small class="text-muted">No hay archivo subido</small>',F&&(F.style.display="none")))}else v.value=y}else console.warn(`Element config_${l} not found during update`)}),console.log("Configuration fields updated successfully")};setTimeout(a,100)},J=async r=>{r.preventDefault();const s=new FormData;N&&c.current&&s.append("id",c.current.value),i.current&&s.append("name",i.current.value),n.current&&s.append("display_name",n.current.value),o.current&&s.append("description",o.current.value),g.current&&s.append("type",g.current.value),E.current&&s.append("is_active",E.current.checked?1:0),_.current&&s.append("requires_proof",_.current.checked?1:0),R.current&&s.append("fee_percentage",R.current.value),S.current&&s.append("fee_fixed",S.current.value),k.current&&s.append("sort_order",k.current.value),b.current&&b.current.files[0]&&s.append("icon",b.current.files[0]);const t={},a={},m=h[q];m&&m.config&&Object.keys(m.config).forEach(u=>{const l=document.getElementById(`config_${u}`);l&&(l.type==="checkbox"?t[u]=l.checked:l.type==="file"&&l.files[0]?(a[u]=l.files[0],t[u]=l.files[0].name):t[u]=l.value)}),s.append("template_key",q),s.append("configuration",JSON.stringify(t)),Object.keys(a).forEach(u=>{s.append(`config_files[${u}]`,a[u])});const M=(m==null?void 0:m.instructions)||{};s.append("instructions",JSON.stringify(M));try{(N?await T.update(s):await T.store(s))&&(f.current&&$(f.current).modal("hide"),p.current&&$(p.current).dxDataGrid("instance").refresh(),w.fire({title:"¡Éxito!",text:`Método de pago ${N?"actualizado":"creado"} correctamente`,icon:"success"}))}catch(u){w.fire({title:"Error",text:u.message||"Error guardando método de pago",icon:"error"})}},V=async({id:r,value:s})=>{try{await T.toggleStatus(r),p.current&&$(p.current).dxDataGrid("instance").refresh()}catch(t){w.fire({title:"Error",text:t.message||"Error cambiando estado",icon:"error"})}},Y=async r=>{if((await w.fire({title:"¿Estás seguro?",text:"Esta acción no se puede deshacer",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"})).isConfirmed)try{await T.destroy(r),p.current&&$(p.current).dxDataGrid("instance").refresh(),w.fire({title:"¡Eliminado!",text:"Método de pago eliminado correctamente",icon:"success"})}catch(t){w.fire({title:"Error",text:t.message||"Error eliminando método de pago",icon:"error"})}},W=r=>{const s=r.target.value;B(s);const t=Object.keys(h).find(a=>h[a].type===s);t&&(P(t),I.current={},C(t,{}),setTimeout(()=>{const a=document.getElementById("instructions-preview-container");if(a){const m=h[t];m&&m.instructions?a.style.display="block":a.style.display="none"}},100))},Z=()=>{const r=h[q];return!r||!r.config?q?null:e.jsxs("div",{className:"alert alert-warning mt-4 mb-0",children:[e.jsx("i",{className:"mdi mdi-information"})," Seleccione un método de pago específico para ver sus campos de configuración."]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-12",children:e.jsx("h5",{className:"mb-3",children:"Configuración específica"})}),Object.entries(r.config).map(([s,t])=>e.jsxs("div",{className:"col-md-6 mb-3",children:[e.jsxs("label",{className:"form-label",children:[t.label,t.required&&e.jsx("span",{className:"text-danger",children:"*"})]}),ee(s,t)]},s))]}),"                ",r.instructions&&e.jsx("div",{className:"row mt-4",id:"instructions-preview-container",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card border-info",children:[e.jsxs("div",{className:"card-header bg-light",children:[e.jsxs("h6",{className:"mb-0 text-info",children:[e.jsx("i",{className:"mdi mdi-information-outline me-2"}),"Vista previa de instrucciones para el usuario"]}),e.jsx("small",{className:"text-muted",children:"Estas son las instrucciones que verán los usuarios al seleccionar este método de pago"})]}),e.jsx("div",{className:"card-body bg-light",children:K(r.instructions)})]})})})]})},K=r=>e.jsxs("div",{className:"instructions-preview",children:[r.title&&e.jsx("div",{className:"mb-3",children:e.jsxs("h6",{className:"text-primary mb-2",children:[e.jsx("i",{className:"mdi mdi-format-title me-1"}),r.title]})}),r.bank_info&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("strong",{className:"text-success",children:[e.jsx("i",{className:"mdi mdi-bank me-1"}),"Datos bancarios:"]}),e.jsx("div",{className:"bg-white p-2 rounded border mt-2",children:e.jsx("ul",{className:"list-unstyled mb-0",children:r.bank_info.map((s,t)=>e.jsx("li",{className:"mb-1",dangerouslySetInnerHTML:{__html:s}},t))})})]}),r.contact_info&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("strong",{className:"text-info",children:[e.jsx("i",{className:"mdi mdi-phone me-1"}),"Información de contacto:"]}),e.jsx("div",{className:"bg-white p-2 rounded border mt-2",children:e.jsx("ul",{className:"list-unstyled mb-0",children:r.contact_info.map((s,t)=>e.jsx("li",{className:"mb-1",dangerouslySetInnerHTML:{__html:s}},t))})})]}),r.account_info&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("strong",{className:"text-warning",children:[e.jsx("i",{className:"mdi mdi-account me-1"}),"Datos de la cuenta:"]}),e.jsx("div",{className:"bg-white p-2 rounded border mt-2",children:e.jsx("ul",{className:"list-unstyled mb-0",children:r.account_info.map((s,t)=>e.jsx("li",{className:"mb-1",dangerouslySetInnerHTML:{__html:s}},t))})})]}),r.steps&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("strong",{className:"text-primary",children:[e.jsx("i",{className:"mdi mdi-format-list-numbered me-1"}),"Pasos a seguir:"]}),e.jsx("div",{className:"bg-white p-2 rounded border mt-2",children:e.jsx("ol",{className:"mb-0",children:r.steps.map((s,t)=>e.jsx("li",{className:"mb-2",dangerouslySetInnerHTML:{__html:s}},t))})})]}),r.qr_display&&e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"alert alert-info border-0",children:[e.jsx("i",{className:"mdi mdi-qrcode me-2 fs-5"}),e.jsx("strong",{children:"Código QR:"})," Se mostrará el código QR que subas en el campo correspondiente.",e.jsx("br",{}),e.jsx("small",{className:"text-muted",children:"Los usuarios podrán escanear el código para realizar el pago directamente."})]})}),r.show_phone&&e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"alert alert-info border-0",children:[e.jsx("i",{className:"mdi mdi-cellphone me-2 fs-5"}),e.jsx("strong",{children:"Número de teléfono:"})," Se mostrará el número configurado para búsqueda manual.",e.jsx("br",{}),e.jsx("small",{className:"text-muted",children:"Útil como alternativa al QR para usuarios que prefieren buscar manualmente."})]})}),r.show_cci&&e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"alert alert-success border-0",children:[e.jsx("i",{className:"mdi mdi-bank-transfer me-2 fs-5"}),e.jsx("strong",{children:"CCI:"})," Se mostrará el código de cuenta interbancario configurado.",e.jsx("br",{}),e.jsx("small",{className:"text-muted",children:"Para transferencias entre diferentes bancos."})]})}),r.note&&e.jsxs("div",{className:"alert alert-warning border-0",children:[e.jsx("i",{className:"mdi mdi-alert-circle-outline me-2 fs-5"}),e.jsx("strong",{children:"Nota importante:"})," ",r.note]}),e.jsx("div",{className:"mt-3 pt-2 border-top",children:e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"mdi mdi-information me-1"}),"Estas instrucciones se generan automáticamente según el tipo de método de pago seleccionado. Los datos específicos (QR, CCI, teléfono) se mostrarán según la configuración que hagas arriba."]})})]}),ee=(r,s)=>{const t=`config_${r}`;switch(s.type){case"text":case"tel":case"url":return e.jsx("input",{type:s.type,id:t,className:"form-control",placeholder:s.placeholder,required:s.required});case"password":return e.jsx("input",{type:"password",id:t,className:"form-control",placeholder:s.placeholder,required:s.required});case"select":return e.jsxs("select",{id:t,className:"form-control",required:s.required,children:[e.jsx("option",{value:"",children:"Seleccionar..."}),Object.entries(s.options||{}).map(([a,m])=>e.jsx("option",{value:a,children:m},a))]});case"boolean":return e.jsxs("div",{className:"form-check",children:[e.jsx("input",{type:"checkbox",id:t,className:"form-check-input"}),e.jsx("label",{className:"form-check-label",htmlFor:t,children:s.label})]});case"file":return s.accept&&s.accept.includes("image")?e.jsxs("div",{children:[e.jsxs("div",{className:"image-upload-container",children:[e.jsx("input",{type:"file",id:t,className:"form-control",accept:s.accept,required:s.required,onChange:a=>{if(a.target.files[0]){const m=new FileReader;m.onload=M=>{const u=document.getElementById(`${t}_preview`);u&&(u.src=M.target.result,u.style.display="block");const l=document.getElementById(`${t}_info`);l&&(l.innerHTML=`<small class="text-success">Archivo seleccionado: ${a.target.files[0].name}</small>`)},m.readAsDataURL(a.target.files[0])}}}),e.jsx("div",{id:`${t}_info`,className:"mt-1"}),e.jsx("img",{id:`${t}_preview`,style:{display:"none",maxWidth:"200px",maxHeight:"150px",marginTop:"10px",border:"1px solid #ddd",borderRadius:"4px",padding:"5px"},alt:"Vista previa"})]}),s.help&&e.jsx("small",{className:"form-text text-muted",children:s.help})]}):e.jsxs("div",{children:[e.jsx("input",{type:"file",id:t,className:"form-control",accept:s.accept,required:s.required}),e.jsx("div",{id:`${t}_info`,className:"mt-1"}),s.help&&e.jsx("small",{className:"form-text text-muted",children:s.help})]});case"textarea":return e.jsx("textarea",{id:t,className:"form-control",rows:"3",placeholder:s.placeholder,required:s.required});default:return e.jsx("input",{type:"text",id:t,className:"form-control",placeholder:s.placeholder,required:s.required})}},re=r=>{switch(r){case"gateway":return"mdi mdi-credit-card";case"qr":return"mdi mdi-qrcode";case"manual":return"mdi mdi-bank";default:return"mdi mdi-credit-card"}},se=r=>{switch(r){case"gateway":return'<span class="badge bg-primary">Gateway</span>';case"qr":return'<span class="badge bg-info">QR/Móvil</span>';case"manual":return'<span class="badge bg-success">Manual</span>';default:return'<span class="badge bg-secondary">Otro</span>'}};return e.jsxs(e.Fragment,{children:["            ",e.jsx(me,{gridRef:p,title:"Métodos de Pago",rest:T,toolBar:r=>{r.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>{p.current&&$(p.current).dxDataGrid("instance").refresh()}}}),r.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Agregar Método",hint:"Agregar Método de Pago",onClick:()=>L()}})},exportable:!0,exportableName:"MetodosPago",columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"icon",caption:"Icono",width:"60px",cellTemplate:(r,{data:s})=>{const t=s.icon?`/storage/payment_icons/${s.icon}`:null;r.html(G.renderToString(e.jsx("div",{className:"text-center",children:t?e.jsx("img",{src:t,alt:s.name,style:{width:"32px",height:"32px",objectFit:"contain"}}):e.jsx("i",{className:`${re(s.type)} fs-4`})})))}},{dataField:"display_name",caption:"Método",cellTemplate:(r,{data:s})=>{r.html(G.renderToString(e.jsxs(e.Fragment,{children:[e.jsx("b",{children:s.display_name}),e.jsx("br",{}),e.jsx("small",{className:"text-muted",children:s.description})]})))}},{dataField:"type",caption:"Tipo",width:"100px",cellTemplate:(r,{data:s})=>{r.html(se(s.type))}},{dataField:"fee_percentage",caption:"Comisión",width:"120px",cellTemplate:(r,{data:s})=>{r.html(G.renderToString(e.jsxs(e.Fragment,{children:[s.fee_percentage>0&&e.jsxs("div",{children:[s.fee_percentage,"%"]}),s.fee_fixed>0&&e.jsxs("div",{children:["S/ ",fe(s.fee_fixed)]}),s.fee_percentage==0&&s.fee_fixed==0&&e.jsx("span",{className:"text-success",children:"Gratis"})]})))}},{dataField:"requires_proof",caption:"Comprobante",width:"100px",cellTemplate:(r,{data:s})=>{r.html(s.requires_proof?'<span class="badge bg-warning">Requerido</span>':'<span class="badge bg-light text-muted">No</span>')}},{dataField:"is_active",caption:"Estado",dataType:"boolean",width:"80px",cellTemplate:(r,{data:s})=>{he(r,e.jsx(D,{checked:s.is_active,onChange:t=>V({id:s.id,value:t.target.checked})}))}},{dataField:"sort_order",caption:"Orden",width:"70px"},{caption:"Acciones",width:"120px",cellTemplate:(r,{data:s})=>{r.css("text-overflow","unset"),r.append(H({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>L(s)})),r.append(H({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>Y(s.id)}))}}]}),e.jsxs(le,{modalRef:f,title:N?"Editar Método de Pago":"Nuevo Método de Pago",onSubmit:J,size:"lg",id:"modalForm",children:[e.jsx("input",{ref:c,type:"hidden"}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsx(O,{eRef:i,label:"Nombre interno",placeholder:"Ej: Yape",required:!0})}),e.jsx("div",{className:"col-md-6",children:e.jsx(O,{eRef:n,label:"Nombre para usuario",placeholder:"Ej: Pago con Yape",required:!0})})]}),"                ",e.jsx(ae,{eRef:o,label:"Descripción",placeholder:"Descripción del método de pago",rows:3}),"                ",e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-4",children:["                        ",e.jsxs(pe,{eRef:g,label:"Tipo de método",required:!0,onChange:W,dropdownParent:"#modalForm",children:[e.jsx("option",{value:"",children:"Seleccionar tipo..."}),h&&[...new Set(Object.values(h).map(r=>r.type))].map(r=>{const s={gateway:"Gateway (Online)",qr:"QR/Móvil",manual:"Manual"};return e.jsx("option",{value:r,children:s[r]||r.charAt(0).toUpperCase()+r.slice(1)},r)})]})]}),e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{className:"form-label",children:["Método de pago específico",e.jsx("span",{className:"text-danger",children:"*"})]}),"                            ",e.jsxs("select",{className:"form-select",value:q,onChange:r=>{const s=r.target.value;if(P(s),console.log("Template changed to:",s),s&&h[s]){const t=h[s].type;B(t),g.current&&$(g.current).val(t).trigger("change");let a={};N&&(j==null?void 0:j.template_key)===s?(a=(j==null?void 0:j.configuration)||{},console.log("Using original saved config for template:",s,a)):N&&(j==null?void 0:j.template_key)!==s?(a={},console.log("Template changed during edit, clearing config")):(a={},console.log("New payment method, using empty config")),I.current=a,setTimeout(()=>{C(s,a)},100)}else I.current={}},required:!0,children:[e.jsx("option",{value:"",children:"Seleccionar método..."}),h&&Object.entries(h).map(([r,s])=>{const a={yape:"Yape",plin:"Plin",culqi:"Culqi",mercadopago:"MercadoPago",transferencia_bancaria:"Transferencia Bancaria",efectivo:"Pago en Efectivo",agente_bancario:"Agente Bancario"}[r]||s.name||r.charAt(0).toUpperCase()+r.slice(1);return e.jsx("option",{value:r,children:a},r)})]}),e.jsx("small",{className:"form-text text-muted",children:"Seleccione el método específico para mostrar sus campos de configuración"})]})}),e.jsx("div",{className:"col-md-4",children:e.jsx(O,{eRef:R,label:"Comisión (%)",type:"number",step:"0.01",min:"0",max:"100",defaultValue:"0"})}),e.jsx("div",{className:"col-md-4",children:e.jsx(O,{eRef:S,label:"Comisión fija (S/)",type:"number",step:"0.01",min:"0",defaultValue:"0"})})]}),e.jsxs("div",{className:"row",children:["                    ",e.jsx("div",{className:"col-md-4",children:e.jsx(de,{eRef:b,label:"Icono",accept:"image/*"})}),e.jsx("div",{className:"col-md-4",children:e.jsx(O,{eRef:k,label:"Orden",type:"number",min:"0",defaultValue:"0"})}),e.jsxs("div",{className:"col-md-4 d-flex flex-column justify-content-end",children:["                        ",e.jsx("div",{className:"mb-3",children:e.jsx(D,{eRef:E,label:"Activo",checked:!0})}),e.jsx("div",{className:"mb-3",children:e.jsx(D,{eRef:_,label:"Requiere comprobante",checked:!1})})]})]}),"                ",e.jsx("div",{id:"dynamic-config-section",children:!h||Object.keys(h).length===0?e.jsxs("div",{className:"alert alert-info mt-4 mb-0",children:[e.jsx("i",{className:"mdi mdi-timer-sand"})," Cargando configuración dinámica..."]}):Z()})]})]})};ue((p,f)=>{ce.createRoot(p).render(e.jsx(oe,{...f,title:"Métodos de Pago",children:e.jsx(xe,{...f})}))});
