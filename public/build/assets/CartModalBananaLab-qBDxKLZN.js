import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as d}from"./index-BOnQTV8N.js";import{R as j}from"./index-BtQtP3Fl.js";import{N as g}from"./Number2Currency-e57Tgsuk.js";import{m as p}from"./main-Bp3JhiuO.js";import{G as x}from"./Global-BM4Id4Pw.js";/* empty css              */import{C as M}from"./CardItem-CdbVCrTF.js";import{A as b}from"./index-BNMCJu8J.js";import{m as s}from"./proxy-DTU49k-A.js";import{c as A}from"./createLucideIcon-DfjclApS.js";import{X as P}from"./x-fof_H3Vv.js";import{S as R}from"./shopping-cart-DLRnxGTD.js";import{A as T}from"./arrow-right-MB8dWH_Y.js";/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=A("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);j.setAppElement("#app");const Q=({data:z,cart:o,setCart:l,modalOpen:r,setModalOpen:v})=>{const[C,f]=d.useState(!1),[w,u]=d.useState(!1);d.useEffect(()=>{r?(document.body.classList.add("overflow-hidden"),document.documentElement.classList.add("overflow-hidden")):(document.body.classList.remove("overflow-hidden"),document.documentElement.classList.remove("overflow-hidden"))},[r]),d.useEffect(()=>{const t=a=>{console.log("ðŸ“¢ CartModal: Carrito actualizado:",a.detail);const i=p.Local.get(`${x.APP_CORRELATIVE}_cart`)||[];console.log("ðŸ”„ CartModal: Cargando carrito desde localStorage:",i),JSON.stringify(i)!==JSON.stringify(o)?(console.log("âœ… CartModal: Actualizando carrito con datos diferentes"),l(i)):console.log("â„¹ï¸ CartModal: Carrito sin cambios, no actualizar"),!r&&a.detail.action==="add"&&S()};return window.addEventListener("cartUpdated",t),()=>{window.removeEventListener("cartUpdated",t)}},[r,l,o]),d.useEffect(()=>{if(r){console.log("ðŸ”„ CartModal: Modal abierto, sincronizando carrito...");const t=p.Local.get(`${x.APP_CORRELATIVE}_cart`)||[];console.log("ðŸ“¦ CartModal: Carrito desde localStorage:",t),l(t)}},[r,l]);const m=()=>{f(!0),setTimeout(()=>{v(!1),f(!1)},300)},N=o.reduce((t,a)=>{const i=a.final_price||a.price||0,n=a.quantity||1;return t+i*n},0),h=o.reduce((t,a)=>t+(a.quantity||1),0),y=o.reduce((t,a)=>{const i=a.price||0,n=a.final_price||a.price||0,c=a.quantity||1;return i>n?t+(i-n)*c:t},0),S=()=>{u(!0),setTimeout(()=>u(!1),1e3)},E={hidden:{x:"100%",opacity:0},visible:{x:0,opacity:1,transition:{type:"spring",damping:25,stiffness:300}},exit:{x:"100%",opacity:0,transition:{ease:"easeInOut",duration:.3}}},L={hidden:{opacity:0,y:20},visible:t=>({opacity:1,y:0,transition:{delay:t*.05,duration:.4}}),exit:{opacity:0,x:50}};return e.jsx(b,{children:r&&e.jsx(j,{isOpen:r,onRequestClose:m,closeTimeoutMS:300,contentLabel:"Carrito de compras",className:"absolute right-0 top-0 bottom-0 bg-white p-6 rounded-l-2xl shadow-2xl w-full max-w-md outline-none h-screen flex flex-col",overlayClassName:"fixed inset-0 z-50",children:e.jsxs(s.div,{className:"flex-1 flex flex-col",initial:"hidden",animate:C?"exit":"visible",exit:"exit",variants:E,children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b border-gray-100",children:[e.jsxs(s.div,{className:"flex items-center gap-3",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2},children:[e.jsx(_,{className:"text-primary",size:24}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Tu Carrito"}),e.jsxs(s.span,{className:"bg-primary text-white text-sm font-medium px-2 py-1 rounded-full",animate:w?{scale:[1,1.1,1],rotate:[0,5,-5,0]}:{},transition:{duration:.6},children:[h," ",h===1?"Ã­tem":"Ã­tems"]})]}),e.jsx(s.button,{onClick:m,whileHover:{scale:1.1},whileTap:{scale:.9},className:"p-1 rounded-full hover:bg-gray-100 transition-colors","aria-label":"Cerrar carrito",children:e.jsx(P,{size:24,className:"text-gray-500"})})]}),o.length>0?e.jsx(s.div,{className:"flex-1 overflow-y-auto pr-2 scroll__carrito",initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:e.jsx(b,{children:o.map((t,a)=>e.jsx(s.div,{custom:a,initial:"hidden",animate:"visible",exit:"exit",variants:L,layout:!0,className:"mb-4",children:e.jsx(M,{...t,setCart:i=>{typeof i=="function"?l(n=>{const c=i(n);return p.Local.set(`${x.APP_CORRELATIVE}_cart`,c),console.log("ðŸ›’ CartModal: Carrito actualizado:",c.length,"items"),c}):(l(i),p.Local.set(`${x.APP_CORRELATIVE}_cart`,i),console.log("ðŸ›’ CartModal: Carrito actualizado:",i.length,"items"))},isModal:!0})},`${t.id}-${a}`))})}):e.jsxs(s.div,{className:"flex-1 flex flex-col items-center justify-center gap-4",initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:[e.jsx(R,{size:48,className:"text-gray-300"}),e.jsx("p",{className:"text-gray-500 text-lg",children:"Tu carrito estÃ¡ vacÃ­o"}),e.jsx(s.button,{onClick:m,whileHover:{scale:1.05},whileTap:{scale:.95},className:"px-6 py-2 bg-primary text-white rounded-lg font-medium",children:"Seguir comprando"})]}),o.length>0&&e.jsxs(s.div,{className:"pt-4 border-t border-gray-100",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:[y>0&&e.jsxs("div",{className:"flex justify-between items-center mb-2 text-green-600",children:[e.jsx("span",{className:"font-medium text-sm",children:"Ahorros totales"}),e.jsxs("span",{className:"font-bold text-sm",children:["-S/. ",g(y)]})]}),e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"Subtotal"}),e.jsxs("span",{className:"text-gray-900 font-bold text-xl",children:["S/. ",g(N)]})]}),e.jsxs(s.a,{href:"/cart",whileHover:{scale:1.02,boxShadow:"0 5px 15px rgba(0,0,0,0.1)"},whileTap:{scale:.98},className:"w-full bg-primary hover:bg-primary-dark text-white py-3 px-6 rounded-xl font-semibold flex items-center justify-center gap-2 transition-colors",children:["Proceder al pago",e.jsx(T,{size:20})]}),e.jsx(s.button,{onClick:m,whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full mt-3 bg-white text-primary border border-primary py-3 px-6 rounded-xl font-medium flex items-center justify-center gap-2 transition-colors",children:"Seguir comprando"})]})]})})})};export{Q as C,_ as S};
